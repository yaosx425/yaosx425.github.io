

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/yaosx425/yaosx425.github.io/img/fluid.png">
  <link rel="icon" href="/yaosx425/yaosx425.github.io/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="姚淑璇">
  <meta name="keywords" content="">
  
    <meta name="description" content="一、简单工厂模式1.解释简单工厂模式（Simple Factory Pattern）属于类的创新型模式，又叫静态工厂方法模式（Static FactoryMethod Pattern），是通过专门定义一个类来负责创建其他类的实例，被创建的实例通常具有共同的父类。 2.包含的角色（1）工厂角色（creator）：简单工厂模式的核心，由它负责创建所有类的内部逻辑。而且工厂必须能够被外界调用，创建所需要">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式">
<meta property="og:url" content="https://github.com/yaosx425/yaosx425.github.io/2021/10/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index.html">
<meta property="og:site_name" content="虫">
<meta property="og:description" content="一、简单工厂模式1.解释简单工厂模式（Simple Factory Pattern）属于类的创新型模式，又叫静态工厂方法模式（Static FactoryMethod Pattern），是通过专门定义一个类来负责创建其他类的实例，被创建的实例通常具有共同的父类。 2.包含的角色（1）工厂角色（creator）：简单工厂模式的核心，由它负责创建所有类的内部逻辑。而且工厂必须能够被外界调用，创建所需要">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-10-18T03:25:31.000Z">
<meta property="article:modified_time" content="2023-02-24T03:32:04.897Z">
<meta property="article:author" content="姚淑璇">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>设计模式 - 虫</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/yaosx425/yaosx425.github.io/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/yaosx425/yaosx425.github.io/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/yaosx425/yaosx425.github.io/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"github.com","root":"/yaosx425/yaosx425.github.io/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/yaosx425/yaosx425.github.io/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/yaosx425/yaosx425.github.io/js/utils.js" ></script>
  <script  src="/yaosx425/yaosx425.github.io/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/yaosx425/yaosx425.github.io/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yaosx425/yaosx425.github.io/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yaosx425/yaosx425.github.io/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yaosx425/yaosx425.github.io/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yaosx425/yaosx425.github.io/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yaosx425/yaosx425.github.io/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/yaosx425/yaosx425.github.io/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="设计模式"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-10-18 11:25" pubdate>
          2021年10月18日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          24k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          198 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">设计模式</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="一、简单工厂模式"><a href="#一、简单工厂模式" class="headerlink" title="一、简单工厂模式"></a>一、简单工厂模式</h1><h2 id="1-解释"><a href="#1-解释" class="headerlink" title="1.解释"></a>1.解释</h2><p>简单工厂模式（Simple Factory Pattern）属于类的创新型模式，又叫静态工厂方法模式（Static FactoryMethod Pattern），是通过专门定义一个类来负责创建其他类的实例，被创建的实例通常具有共同的父类。</p>
<h2 id="2-包含的角色"><a href="#2-包含的角色" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）工厂角色（creator）：简单工厂模式的核心，由它负责创建所有类的内部逻辑。而且工厂必须能够被外界调用，创建所需要的产品对象。</p>
<p>（2）抽象产品角色（product）：简单工厂模式所创建的所有对象的父类，注意，这里的父类可以是接口类也可以是抽象类，它负责描述所有实例所共有的公共接口。</p>
<p>（3）具体产品角色（concrete product）：简单工厂所创建的具体实例对象，这些具体的产品往往拥有共同的父类。</p>
<h2 id="3-使用场景分析及代码实现"><a href="#3-使用场景分析及代码实现" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>————–食品加工工厂实现代码——————-</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象产品角色</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">Food</span>&#123;<br>    <span class="hljs-comment">//获得相应的食物</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体产品角色</span><br><span class="hljs-comment">//麦香鸡</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">McChicken</span> <span class="hljs-title">implements</span> <span class="hljs-title">Food</span>&#123;<br>    <span class="hljs-comment">//获得一份麦香鸡</span><br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;一份麦香鸡&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//薯条</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Chips</span> <span class="hljs-title">implements</span> <span class="hljs-title">Food</span>&#123;<br>    <span class="hljs-comment">//获得一份薯条</span><br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;一份薯条&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//工厂角色</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FoodFactory</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Food <span class="hljs-title">getFood</span>(<span class="hljs-params">String type</span>) throws InstantiationException,IllegalAccessException,ClassNotFoundException</span>&#123;<br>        <span class="hljs-keyword">if</span>(type.equalsIgnoreCase(<span class="hljs-string">&#x27;mcchicken&#x27;</span>))&#123;<br>            <span class="hljs-keyword">return</span> McChicken.<span class="hljs-keyword">class</span>.newInstance();<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(type.equalsIgnoreCase(<span class="hljs-string">&quot;chips&quot;</span>))&#123;<br>            <span class="hljs-keyword">return</span> Chips.<span class="hljs-keyword">class</span>.newInstance();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;找不到相应的实例化类了！&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SimpleFactoryTest</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)throws InstantiationException,IllegalAccessException,ClassNotFoundException</span>&#123;<br>        <span class="hljs-comment">//实例化各种食物</span><br>        Food mcChicken = FoodFactory.getFood(<span class="hljs-string">&quot;McChicken&quot;</span>);<br>        Food chips = FoodFactory.getFood(<span class="hljs-string">&quot;Chips&quot;</span>);<br>        Food eggs = FoodFactory.getFood(<span class="hljs-string">&quot;Eggs&quot;</span>);<br>        <span class="hljs-comment">//获取食物</span><br>        <span class="hljs-keyword">if</span>(mcChicken != <span class="hljs-literal">null</span>)&#123;<br>            mcChicken.<span class="hljs-keyword">get</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(chips != <span class="hljs-literal">null</span>)&#123;<br>            chips.<span class="hljs-keyword">get</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(eggs != <span class="hljs-literal">null</span>)&#123;<br>            eggs.<span class="hljs-keyword">get</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*结果</span><br><span class="hljs-comment">找不到相应的实例化类了</span><br><span class="hljs-comment">一份麦香鸡</span><br><span class="hljs-comment">一份薯条*/</span><br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析"><a href="#4-优缺点分析" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：用户可以直接根据工厂类去创建所需的实例。</p>
<p>缺点：违背了单一原则、开放封闭原则。工厂类集中了所有实例的创建逻辑，如果一旦这个工厂出了问题，所有的客户端都会受到牵连；简单工厂模式的产品都基于一个共同的抽象类或者接口，即有不同的产品接口或者抽象类的时候，工厂类就需要判断何时创建何种产品，这就和创建何种种类产品的产品相互混淆；开放封闭原则中，每当我新增加一个产品的时候必须修改工厂类，相应的工厂类就需要重新编译一遍。</p>
<h1 id="二、工厂方法模式"><a href="#二、工厂方法模式" class="headerlink" title="二、工厂方法模式"></a>二、工厂方法模式</h1><h2 id="1-解释-1"><a href="#1-解释-1" class="headerlink" title="1.解释"></a>1.解释</h2><p>工厂方法模式属于类的创建型模式，又称为多态工厂模式。工厂方法模式的意义在于定义一个创建产品对象的工厂接口，将实际创建工作推迟到子类当中。核心工厂类不再负责产品的创建，仅负责声明具体工厂类必须实现的接口。</p>
<h2 id="2-包含的角色-1"><a href="#2-包含的角色-1" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象产品角色：具体产品的父类。</p>
<p>（2）具体产品角色：抽象产品的子类。</p>
<p>（3）抽象工厂角色：具体工厂的父类。</p>
<p>（4）具体工厂角色：抽象工厂的子类。</p>
<p>工厂和产品之间的关系是具体工厂中调用具体产品类，生成具体的产品。</p>
<h2 id="3-使用场景分析及代码实现-1"><a href="#3-使用场景分析及代码实现-1" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>————-工厂实例————-</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-comment">//抽象工厂角色</span><br>public interface <span class="hljs-type">Factory</span>&#123;<br>    <span class="hljs-comment">//生产产品</span><br>    public <span class="hljs-type">Product</span> manufacture();<br>&#125;<br><span class="hljs-comment">//抽象产品角色</span><br>public interface <span class="hljs-type">Product</span>&#123;<br>    <span class="hljs-comment">//产品的属性</span><br>    public void show();<br>&#125;<br><span class="hljs-comment">//具体产品角色</span><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Product</span></span>&#123;<br>	<span class="hljs-meta">@Override</span><br>    public void show()&#123;<br>        <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;生产出了产品A&quot;</span>);<br>    &#125;<br>&#125;<br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Product</span></span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    public void show()&#123;<br>        <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;生产出了产品B&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体工厂角色</span><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FactoryA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span></span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    public <span class="hljs-type">Product</span> manufacture()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">ProductA</span>();<br>    &#125;<br>&#125;<br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FactoryB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span></span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    public <span class="hljs-type">Product</span> manufacture()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">ProductB</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试</span><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span></span>&#123;<br>    public static void main(<span class="hljs-type">String</span>[] args)&#123;<br>        <span class="hljs-comment">//生产产品A</span><br>        <span class="hljs-type">FactoryA</span> mFactoryA = <span class="hljs-keyword">new</span> <span class="hljs-type">FactoryA</span>();<br>        mFactoryA.manufacture().show();<br>        <span class="hljs-comment">//生产产品B</span><br>        <span class="hljs-type">FactoryB</span> mFactoryB = <span class="hljs-keyword">new</span> <span class="hljs-type">FactoryB</span>();<br>        mFactoryB.manufacture().show();<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*结果</span><br><span class="hljs-comment">生产出了产品A</span><br><span class="hljs-comment">生产出了产品B*/</span><br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-1"><a href="#4-优缺点分析-1" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>（1）符合开闭原则，新增一种产品的时候，只需要增加相应的具体产品类和相应的工厂子类即可。</p>
<p>（2）符合单一职责原则，每个具体工厂类只负责创建对应的产品。</p>
<p>（3）不使用静态工厂方法，可以形成基于继承的等级结构。</p>
<p>缺点：</p>
<p>（1）添加新产品时，除了增加新产品类外，还要提供与之对应的具体工厂类，系统类的个数将成对增加。</p>
<p>（2）虽然保证了工厂方法内对修改关闭，但对于使用工厂方法的类，如果要更换另外一种产品，仍然需要修改实例化的具体工厂类。</p>
<p>（3）一个具体工厂只能创建一种具体产品。</p>
<h1 id="三、抽象工厂模式"><a href="#三、抽象工厂模式" class="headerlink" title="三、抽象工厂模式"></a>三、抽象工厂模式</h1><h2 id="1-解释-2"><a href="#1-解释-2" class="headerlink" title="1.解释"></a>1.解释</h2><p>提供一个创建一系列相关或相互依赖对象的接口，而无须指定它们具体的类。抽象工厂模式又称为Kit模式，属于对象创建型模式，是工厂方法模式的升级版，在有<strong>多个业务品种、业务分类</strong>时，通过抽象工厂模式产生需要的对象是一种非常好的解决方式。</p>
<h2 id="2-包含的角色-2"><a href="#2-包含的角色-2" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象工厂：声明生成抽象产品的工厂。</p>
<p>（2）具体工厂：实现了抽象工厂声明的生成抽象产品的方法，生成一组具体的产品。</p>
<p>（3）抽象产品：在抽象产品中定义了产品的抽象业务方法。</p>
<p>（4）具体产品：定义具体工厂生产的具体产品对象，实现抽象产品接口中定义的业务方法。</p>
<h2 id="3-使用场景分析及代码实现-2"><a href="#3-使用场景分析及代码实现-2" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>———————-游戏产品—————–</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象工厂</span><br><span class="hljs-comment">//游戏界面</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">GameInterface</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">interface</span>()</span>;<br>&#125;<br><span class="hljs-comment">//游戏操作</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">GameOperation</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">operation</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体工厂</span><br><span class="hljs-comment">//游戏界面具体工厂</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AndroidInterface</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameInterface</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">interface</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Android游戏界面控制&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IOSInterface</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameInterface</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">interface</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;IOS游戏界面控制&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WindowInterface</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameInterface</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">interface</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Window游戏界面控制&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//游戏操作具体工厂</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AndroidOperation</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameOperation</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">operation</span>()</span>&#123;<br>      System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Andriod游戏控制&quot;</span>);  <br>	&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IOSOperation</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameOperation</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">operation</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;IOS游戏控制&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WindowOperation</span> <span class="hljs-title">implement</span> <span class="hljs-title">GameOperation</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">operation</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Window游戏控制&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象工厂-游戏工厂类</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">GameFactory</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameInterface <span class="hljs-title">interfaceController</span>()</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameOperation <span class="hljs-title">operationController</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体工厂</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> AndroidController implement <span class="hljs-title">GameFactory</span>()</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameInterface <span class="hljs-title">interfaceController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AndroidInterface();<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameOperation <span class="hljs-title">operationController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AndroidOperation();<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> IOSController implement <span class="hljs-title">GameFactory</span>()</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameInterface <span class="hljs-title">interfaceController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IOSInterface();<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameOperation <span class="hljs-title">operationController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IOSOperation();<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> WindowController implement <span class="hljs-title">GameFactory</span>()</span>&#123;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameInterface <span class="hljs-title">interfaceController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WindowInterface();<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> GameOperation <span class="hljs-title">operationController</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WindowOperation();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Client</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        GameFactory andriodGame = <span class="hljs-keyword">new</span> AndriodController();<br>        GameInterface andriodInterface = andriodGame.interfaceController();<br>        GameOperation andriodOperation = andriodGame.operationController();<br>        andriodInterface.<span class="hljs-keyword">interface</span>();<br>        andriodOperation.operation();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-2"><a href="#4-优缺点分析-2" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>(1)隔离了具体类的生成，使得客户并不需要知道什么被创建，具有良好的封装性。</p>
<p>(2)横向扩展简单。同个产品族如果需要增加多个产品，只需要增加新的工厂类和产品类即可。</p>
<p>缺点：</p>
<p>纵向扩展困难，如果增加了新的产品族，抽象工厂类也要添加创建该产品族的对应方法，这样一来所有的具体工厂类都要做修改了，严重违背了开闭原则。</p>
<h1 id="四、建造者模式"><a href="#四、建造者模式" class="headerlink" title="四、建造者模式"></a>四、建造者模式</h1><h2 id="1-解释-3"><a href="#1-解释-3" class="headerlink" title="1.解释"></a>1.解释</h2><p>建造者模式是指 指挥者 指挥 建造者 建造产品。不同的具体建造者定义了不同的创建过程，且具体的建造者相互独立，增加新的建造者非常方便，无须修改已有的代码，系统具有较好的扩展性。</p>
<h2 id="2-包含的角色-3"><a href="#2-包含的角色-3" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象建造者（Builder）：接口中包含一个要建造的产品，建造这个产品各个部分的方法。</p>
<p>（2）具体建造者（Concrete Builder）：它实现了抽象建造者接口，实现各个部件的具体构造和装备方法，定义并明确它所创建的复杂对象，也可以提供一个方法返回创建好的复杂产品对象。</p>
<p>（3）产品角色（Product）：它是被构建的复杂对象，包含多个组成部件，具体建造者创建该产品的内部表示并定义它的装配过程。</p>
<p>（4）指挥者（Director）：它负责安排复杂对象的建造次序，指挥者与抽象建造者之间存在关联关系。客户端一般只需要与指挥者进行交互，在客户端确定具体建造者的类型，并实例化具体建造者对象（也可以通过配置文件和反射机制）。</p>
<h2 id="3-使用场景分析及代码实现-3"><a href="#3-使用场景分析及代码实现-3" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>———–汽车建造过程————–</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//产品-小汽车</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;<br>   <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-keyword">type</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">showProduct</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;名称：&quot;</span>+name);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;型号：&quot;</span>+<span class="hljs-keyword">type</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setName</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> name</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setType</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> <span class="hljs-keyword">type</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-keyword">type</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象建造者</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Builder</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setPart</span>(<span class="hljs-title class_">String</span> arg1,<span class="hljs-title class_">String</span> arg2);<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Product</span> <span class="hljs-title function_">getProduct</span>();<br>&#125;<br><span class="hljs-comment">//具体建造者</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteBuilder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Builder</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Product</span> product = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Product</span> <span class="hljs-title function_">getProduct</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> product;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setPart</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> arg1,<span class="hljs-title class_">String</span> arg2</span>)&#123;<br>        product.<span class="hljs-title function_">setName</span>(arg1);<br>        product.<span class="hljs-title function_">setType</span>(arg2);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//指挥者</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Director</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Builder</span> builder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteBuilder</span>();<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Product</span> <span class="hljs-title function_">getAProduct</span>(<span class="hljs-params"></span>)&#123;<br>        builder.<span class="hljs-title function_">setPart</span>(<span class="hljs-string">&quot;宝马汽车&quot;</span>，<span class="hljs-string">&quot;X7&quot;</span>);<br>        <span class="hljs-keyword">return</span> builder.<span class="hljs-title function_">getProduct</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Product</span> <span class="hljs-title function_">getBProduct</span>(<span class="hljs-params"></span>)&#123;<br>        builder.<span class="hljs-title function_">setPart</span>(<span class="hljs-string">&quot;奥迪汽车&quot;</span>,<span class="hljs-string">&quot;Q5&quot;</span>);<br>        <span class="hljs-keyword">return</span> builder.<span class="hljs-title function_">getProduct</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span>&#123;<br>    <span class="hljs-title class_">Director</span> director = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Director</span>();<br>    <span class="hljs-title class_">Product</span> product1 = director.<span class="hljs-title function_">getAProduct</span>();<br>    product1.<span class="hljs-title function_">showProduct</span>();<br>    <span class="hljs-title class_">Product</span> product2 = director.<span class="hljs-title function_">getBProduct</span>();<br>    product2.<span class="hljs-title function_">showProduct</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-3"><a href="#4-优缺点分析-3" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>建造者的封装性很好，使用建造者模式可以有效的封装变化，所以，一般产品类和建造者类是比较稳定的。将主要的业务逻辑封装在指挥者类中对整体而言可以取得比较好的稳定性。</p>
<p>建造者模式很容易进行扩展。如果有新的需求，通过实现一个新的建造者类就可以完成，基本上不用修改之前已经测试通过的代码。</p>
<p>由于具体的建造者是独立的，因此可以对建造过程逐步细化，而不对其他的模块产生任何影响。</p>
<p>缺点：</p>
<p>建造者模式所创建的产品一般具有较多的共同点，其组成部分相似，如果产品之间的差异性很大，则不适合使用建造者模式，因此其使用范围受到一定的限制。</p>
<p>如果产品的内部变化复杂，可能会导致需要定义很多具体建造类来实现这种变化，导致系统变得很庞大，可维护性变差。</p>
<h1 id="五、原型模式"><a href="#五、原型模式" class="headerlink" title="五、原型模式"></a>五、原型模式</h1><h2 id="1-解释-4"><a href="#1-解释-4" class="headerlink" title="1.解释"></a>1.解释</h2><p>原型模式是一种对象创建型模式，建造者模式是一种对象创建型模式，用原型模式可以用原型实例指定创建原型的种类，它允许通过一个原型对象创建多个同类型的其他对象，而无需知道该对象的创建细节，在java中可以直接使用Object提供的clone方法来实现对象的克隆（浅克隆）。</p>
<h2 id="2-包含的角色-4"><a href="#2-包含的角色-4" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象原型类（Prototype）：给出所有的具体原型类所需的接口。</p>
<p>（2）具体原型类（Concrete Prototype）：被复制的对象，此角色需要实现抽象的原型角色所要求的接口。</p>
<h2 id="3-使用场景分析及代码实现-4"><a href="#3-使用场景分析及代码实现-4" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>——————汽车型号的批量生产———————</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//浅克隆</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Brand</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">install</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;安装汽车品牌&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> <span class="hljs-title">implements</span> <span class="hljs-title">Cloneable</span>&#123;<br>    <span class="hljs-keyword">private</span> Brand brand;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span>()</span>&#123;<br>        <span class="hljs-keyword">this</span>.brand = <span class="hljs-keyword">new</span> Brand();<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span>() throws CloneNotSupportedException</span>&#123;<br>        <span class="hljs-keyword">return</span> (Car)super.clone();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Brand <span class="hljs-title">getBrand</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.brand;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;小汽车能跑了&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//深克隆</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Brand</span> <span class="hljs-title">implement</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">install</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;安装汽车品牌&quot;</span>);<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span>() throws CloneNotSupportedException</span>&#123;<br>    	super.clone();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> <span class="hljs-title">implements</span> <span class="hljs-title">Cloneable</span>&#123;<br>    <span class="hljs-keyword">private</span> Brand brand;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span>()</span>&#123;<br>        <span class="hljs-keyword">this</span>.brand = <span class="hljs-keyword">new</span> Brand();<br>    &#125;<br>    @Override<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span>() throws CloneNotSupportedException</span>&#123;<br>       Car car = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>            car = (Car)super.clone();<br>            car.brand = (Brand)brand.clone();<br>        &#125;<span class="hljs-keyword">catch</span>(Exception e)&#123;<br>            System.<span class="hljs-keyword">out</span>.println(e.getMessage());<br>        &#125;<br>        <span class="hljs-keyword">return</span> car;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Brand <span class="hljs-title">getBrand</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.brand;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;小汽车能跑了&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-4"><a href="#4-优缺点分析-4" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：原型模式简化了创建对象的过程，通过一个已有的实例进行复制提高了创建实例的效率，具有较好的可扩展性。</p>
<p>缺点：部分时候实现克隆可能较为麻烦。</p>
<h1 id="六、单例模式"><a href="#六、单例模式" class="headerlink" title="六、单例模式"></a>六、单例模式</h1><h2 id="1-解释-5"><a href="#1-解释-5" class="headerlink" title="1.解释"></a>1.解释</h2><p>单例模式是指确保一个类在任何情况下都绝对只有一个实例，并提供一个全局访问点。</p>
<p>该模式有三个基本要点：一是这个类只能有一个实例；二是它必须自行创建这个实例；三是它必须自行向整个系统提供这个实例。</p>
<h2 id="2-分类及基本代码展示分析"><a href="#2-分类及基本代码展示分析" class="headerlink" title="2.分类及基本代码展示分析"></a>2.分类及基本代码展示分析</h2><p>1.饿汉式单例模式</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HungrySingleton</span>&#123;<br>    <span class="hljs-keyword">private</span> final <span class="hljs-keyword">static</span> HungrySingleton HUNGRY_SINGLETON = <span class="hljs-keyword">new</span> HungrySingleton();<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">HungrySingleton</span>()</span>&#123;<br>        <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HungrySingleton <span class="hljs-title">getInstance</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> HUNGRY_SINGLETON;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>饿汉式在类创建的同时就已经创建好了一个静态的对象供系统使用，以后不再改变，所以天生是线程安全的。</p>
<p>饿汉式模式适用于单例模式较少的场景；如果我们在程序启动后，一定会加载到类，那么用饿汉模式实现的单例模式简单又实用；如果我们是写一些工具类，则优先考虑使用懒汉模式，可以避免提前被加载到内存中，占用系统资源。</p>
<p>2.懒汉式单例模式（双重检查锁）</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LazyDoubleCheckSingleton</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> LazyDoubleCheckSingleton lazyDoubleCheckSingleton =<span class="hljs-literal">null</span>;<br>    <span class="hljs-comment">//volatile关键字可以保证线程间变量的可见性，还有一个作用就是阻止局部重排序的发生。</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">LazyDoubleCheckSingleton</span>()</span>&#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LazyDoubleCheckSingleton <span class="hljs-title">getInstance</span>()</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==lazyDoubleCheckSingleton)&#123;<br>            synchronized(LazyDoubleCheckSingleton.<span class="hljs-keyword">class</span>)&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==lazyDoubleCheckSingleton)&#123;<br>                    lazyDoubleCheckSingleton = <span class="hljs-keyword">new</span> LazyDoubleCheckSingleton();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> lazyDoubleCheckSingleton;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>相比于单锁而言，双重检查性能上虽然有提升，但是依旧用到了synchronized关键字总归要上锁，对程序性能还是存在一定的性能影响。注意里面volatile的使用。</p>
<h2 id="3-区别"><a href="#3-区别" class="headerlink" title="3.区别"></a>3.区别</h2><p>（1）饿汉就是类一旦加载，就把单例初始化完成，保证getInstance的时候，单例是已经存在的了，而懒汉比较懒，只有当调用getInstance的时候，才回去初始化这个单例。</p>
<p>（2）懒汉式本身是非线程安全的，但是上述写法实现了线程安全；饿汉式天生就是线程安全的，可以直接用于多线程而不会出现问题。</p>
<p>（3）饿汉式在类创建的同时就实例化一个静态对象出来，不管之后会不会使用这个单例，都会占据一定的内存，但是相应的，在第一次调用时速度也会更快，因为其资源已经初始化完成。而懒汉式顾名思义，会延迟加载，在第一次使用该单例的时候才会实例化对象出来，第一次调用时要做初始化，如果要做的工作比较多，性能上会有些延迟，之后就和饿汉式一样了。</p>
<h1 id="七、适配器模式"><a href="#七、适配器模式" class="headerlink" title="七、适配器模式"></a>七、适配器模式</h1><h2 id="1-解释-6"><a href="#1-解释-6" class="headerlink" title="1.解释"></a>1.解释</h2><p>将一个类的接口转换成客户希望的另外一个接口，使得原本由于接口不兼容而不能一起工作的那些类能一起工作。</p>
<h2 id="2-包含的角色-5"><a href="#2-包含的角色-5" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）目标接口（Target）：当前系统业务所期待的接口，他可以是抽象类或接口。</p>
<p>（2）适配者类（Adaptee）：它是被访问和适配的现存组件库中的组件接口。</p>
<p>（3）适配器类（Adapter）：它是一个转换器，通过继承或引用适配者的对象，把适配者接口转换成目标接口，让客户按目标接口的格式访问适配者。</p>
<h2 id="3-使用场景分析及代码实现-5"><a href="#3-使用场景分析及代码实现-5" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//目标接口</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Target</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">request</span>()</span>;<br>&#125;<br><span class="hljs-comment">//适配者类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Adaptee</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">specificRequest</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;适配者中的业务代码被调用！&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//类适配器类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ClassAdapter</span> <span class="hljs-title">extends</span> <span class="hljs-title">Adaptee</span> <span class="hljs-title">implements</span> <span class="hljs-title">Target</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">request</span>()</span>&#123;<br>        specificRequest();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ClassAdapterTest</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;类适配器模式测试：&quot;</span>);<br>        Target target = <span class="hljs-keyword">new</span> ClassAdapter();<br>        target.request();<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*结果</span><br><span class="hljs-comment">类适配器模式测试：</span><br><span class="hljs-comment">适配器中的业务代码被调用！*/</span><br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-5"><a href="#4-优缺点分析-5" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>（1）客户端通过适配器可以透明的调用目标接口。</p>
<p>（2）复用了现存的类，程序员不需要修改原有代码而重用现有的适配者类。</p>
<p>（3）将目标类和适配者类解耦，解决了目标类和适配者类接口不一致的问题。</p>
<p>（4）在很多业务场景中符合开闭原则。</p>
<p>缺点：</p>
<p>（1）适配器编写过程中需要结合业务场景全面考虑，可能会增加系统的复杂性。</p>
<p>（2）增加代码阅读难度，降低代码可读性，过多的使用适配器会使系统代码变得凌乱。</p>
<h1 id="八、桥接模式"><a href="#八、桥接模式" class="headerlink" title="八、桥接模式"></a>八、桥接模式</h1><h2 id="1-解释-7"><a href="#1-解释-7" class="headerlink" title="1.解释"></a>1.解释</h2><p>桥接模式（Bridge Pattern）：<strong>将抽象部分和他的实现部分分离，使它们都可以独立的变化</strong>。它是一种<strong>对象结构型模式</strong>，又称为柄体（Handle and Boy）模式或者接口（Interface）模式。如果某个类存在两个独立变化的维度，可以运用桥接模式将这两个维度分离出来，让系统更加符合”单一职责原则”。<strong>桥接模式中是在抽象类里面建立一个抽象关联</strong>，该关联关系就像是一条桥一样，将两个独立继承结构的类联结起来。</p>
<h2 id="2-包含的角色-6"><a href="#2-包含的角色-6" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象类（Abstraction）：用于定义抽象类的接口，它一般是抽象类而不是接口。它既可以包含抽象业务方法，也可以包含具体业务方法。</p>
<p>（2）扩充抽象类（Refined Abstraction）：扩充由Abstraction定义的接口，通常情况下它不再是抽象类而是具体类，它实现了在Abstraction中声明的抽象业务方法。</p>
<p>（3）实现类接口（Implementor）：Implementor接口仅提供基本操作，而Abstraction定义的接口可能会做更多更复杂的操作。</p>
<p>（4）具体实现类（Concrete Implementor）：具体实现Implementor接口，在不同的Concrete Implementor中提供基本操作的不同实现。</p>
<h2 id="3-使用场景分析及代码实现-6"><a href="#3-使用场景分析及代码实现-6" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>———————–不同交通工具在不同的道路行驶—————-</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//交通工具(Implementor)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Vehicle</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drive</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-comment">//具体的交通工具(ConcreteImplementor)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Vehicle</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drive</span><span class="hljs-params">()</span><br>    &#123;<br>        System.out.print(<span class="hljs-string">&quot;小轿车&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Bus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Vehicle</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drive</span><span class="hljs-params">()</span><br>    &#123;<br>        System.out.print(<span class="hljs-string">&quot;大巴&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象的路（Abstraction）</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Road</span><br>&#123;<br>    <span class="hljs-keyword">protected</span> Vehicle vehicle;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Road</span><span class="hljs-params">(Vehicle vehicle)</span><br>    &#123;<br>        <span class="hljs-built_in">this</span>.vehicle = vehicle;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">driveOnRoad</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-comment">//具体的路（Concrete Implementor）</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UnpavedRoad</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Road</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UnpavedRoad</span><span class="hljs-params">(Vehicle vehicle)</span><br>    &#123;<br>        <span class="hljs-built_in">super</span>(vehicle);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">driveOnRoad</span><span class="hljs-params">()</span><br>    &#123;<br>        <span class="hljs-built_in">super</span>.vehicle.drive();<br>        System.out.println(<span class="hljs-string">&quot;行驶在石子路&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CementRoad</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Road</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CementRoad</span><span class="hljs-params">(Vehicle vehicle)</span><br>    &#123;<br>        <span class="hljs-built_in">super</span>(vehicle);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">driveOnRoad</span><span class="hljs-params">()</span><br>    &#123;<br>        <span class="hljs-built_in">super</span>.vehicle.drive();<br>        System.out.println(<span class="hljs-string">&quot;行驶在水泥路&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试</span><br>        <span class="hljs-type">Road</span> <span class="hljs-variable">road</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CementRoad</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>());<br>        road.driveOnRoad();<br><span class="hljs-comment">/*结果</span><br><span class="hljs-comment">小轿车行驶在水泥路*/</span><br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-6"><a href="#4-优缺点分析-6" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>（1）分离抽象接口及其实现部分。桥接模式使用”对象间的关联关系”解耦了抽象和实现类之间固有的绑定关系，使得抽象和实现不再同一个继承层次结构中，使他们都具有自己的子类。</p>
<p>（2）在很多情况下，桥接模式可以取代多层继承方案，它极大减少了子类的个数。</p>
<p>（3）桥接模式提高了系统的可扩展性，在两个变化维度中任意扩展一个维度，都不需要修改原有系统，符合”开闭原则”。</p>
<p>缺点：</p>
<p>（1）桥接模式的使用会增加系统的理解与设计难度，由于关联关系建立在抽象层，要去开发者一开始就针对抽象层进行设计与编程。</p>
<p>（2）桥接模式要求正确识别出系统中两个独立变化的维度，因此其使用范围具有一定的局限性，如何正确识别两个独立维度也需要一定的经验积累。</p>
<h1 id="九、组合模式"><a href="#九、组合模式" class="headerlink" title="九、组合模式"></a>九、组合模式</h1><h2 id="1-解释-8"><a href="#1-解释-8" class="headerlink" title="1.解释"></a>1.解释</h2><p>组合模式对单个对象（叶子对象）和组合对象（组合对象）具有一致性，它将对象组织到树结构中，可以用来描述整体与部分的关系。组合对象最关键的一点就是叶子对象和组合对象实现相同的接口。</p>
<h2 id="2-包含的角色-7"><a href="#2-包含的角色-7" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）对象声明接口（Component）：声明一个接口用于访问和管理Component子部件。</p>
<p>（2）叶子对象（Leaf）：叶子对象，叶子结点没有子结点。</p>
<p>（3）容器对象（Composite）：容器对象，定义有枝节点行为，用来存储子部件。</p>
<h2 id="3-使用场景分析及代码实现-7"><a href="#3-使用场景分析及代码实现-7" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//对象声明接口</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">File</span> &#123;<br>    String name;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">File</span>(<span class="hljs-params">String name</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span>(<span class="hljs-params">String name</span>)</span> &#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span>()</span>;<br>&#125;<br><span class="hljs-comment">//容器对象</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Folder</span> <span class="hljs-title">extends</span> <span class="hljs-title">File</span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;File&gt; files;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Folder</span>(<span class="hljs-params">String name</span>)</span>&#123;<br>        super(name);<br>        files = <span class="hljs-keyword">new</span> ArrayList&lt;File&gt;();<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 浏览文件夹中的文件</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span>()</span> &#123;<br>        <span class="hljs-keyword">for</span>(File <span class="hljs-keyword">file</span> : files)&#123;<br>            <span class="hljs-keyword">file</span>.display();<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * @desc 向文件夹中添加文件</span><br><span class="hljs-comment">     * @param file</span><br><span class="hljs-comment">     * @return void</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params">File <span class="hljs-keyword">file</span></span>)</span>&#123;<br>        files.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">file</span>);<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * @desc 从文件夹中删除文件</span><br><span class="hljs-comment">     * @param file</span><br><span class="hljs-comment">     * @return void</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span>(<span class="hljs-params">File <span class="hljs-keyword">file</span></span>)</span>&#123;<br>        files.<span class="hljs-keyword">remove</span>(<span class="hljs-keyword">file</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//叶子对象</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TextFile</span> <span class="hljs-title">extends</span> <span class="hljs-title">File</span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TextFile</span>(<span class="hljs-params">String name</span>)</span> &#123;<br>        super(name);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;这是文本文件，文件名：&quot;</span> + super.getName());<br>    &#125;<br>    <br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ImagerFile</span> <span class="hljs-title">extends</span> <span class="hljs-title">File</span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ImagerFile</span>(<span class="hljs-params">String name</span>)</span> &#123;<br>        super(name);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;这是图像文件，文件名：&quot;</span> + super.getName());<br>    &#125;<br><br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">VideoFile</span> <span class="hljs-title">extends</span> <span class="hljs-title">File</span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">VideoFile</span>(<span class="hljs-params">String name</span>)</span> &#123;<br>        super(name);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;这是影像文件，文件名：&quot;</span> + super.getName());<br>    &#125;<br><br>&#125;<br><span class="hljs-comment">//客户端测试</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span> &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 我们先建立一个这样的文件系统</span><br><span class="hljs-comment">         *                  总文件</span><br><span class="hljs-comment">         *                  </span><br><span class="hljs-comment">         *   a.txt    b.jpg                   c文件夹              </span><br><span class="hljs-comment">         *                      c_1.text  c_1.rmvb    c_1.jpg   </span><br><span class="hljs-comment">         *                                                       </span><br><span class="hljs-comment">         */</span> <br>        <span class="hljs-comment">//总文件夹</span><br>        Folder zwjj = <span class="hljs-keyword">new</span> Folder(<span class="hljs-string">&quot;总文件夹&quot;</span>);<br>        <span class="hljs-comment">//向总文件夹中放入三个文件：1.txt、2.jpg、1文件夹</span><br>        TextFile aText= <span class="hljs-keyword">new</span> TextFile(<span class="hljs-string">&quot;a.txt&quot;</span>);<br>        ImagerFile bImager = <span class="hljs-keyword">new</span> ImagerFile(<span class="hljs-string">&quot;b.jpg&quot;</span>);<br>        Folder cFolder = <span class="hljs-keyword">new</span> Folder(<span class="hljs-string">&quot;C文件夹&quot;</span>);<br>        <br>        zwjj.<span class="hljs-keyword">add</span>(aText);<br>        zwjj.<span class="hljs-keyword">add</span>(bImager);<br>        zwjj.<span class="hljs-keyword">add</span>(cFolder);<br>        <br>        <span class="hljs-comment">//向C文件夹中添加文件：c_1.txt、c_1.rmvb、c_1.jpg </span><br>        TextFile cText = <span class="hljs-keyword">new</span> TextFile(<span class="hljs-string">&quot;c_1.txt&quot;</span>);<br>        ImagerFile cImage = <span class="hljs-keyword">new</span> ImagerFile(<span class="hljs-string">&quot;c_1.jpg&quot;</span>);<br>        VideoFile cVideo = <span class="hljs-keyword">new</span> VideoFile(<span class="hljs-string">&quot;c_1.rmvb&quot;</span>);<br>        <br>        cFolder.<span class="hljs-keyword">add</span>(cText);<br>        cFolder.<span class="hljs-keyword">add</span>(cImage);<br>        cFolder.<span class="hljs-keyword">add</span>(cVideo);<br>        <br>        <span class="hljs-comment">//遍历C文件夹</span><br>        cFolder.display();<br>        <span class="hljs-comment">//将c_1.txt删除</span><br>        cFolder.<span class="hljs-keyword">remove</span>(cText);<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;-----------------------&quot;</span>);<br>        cFolder.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-7"><a href="#4-优缺点分析-7" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>（1）可以清楚地定义分层次的复杂对象，表示对象的全部或部分层次，使得增加新构件也更容易。</p>
<p>（2）客户端调用简单，客户端可以一致的使用组合结构或其中单个对象。</p>
<p>（3）定义了包含叶子对象和容器对象的类层次结构，叶子对象不断递归下去，可以形成复杂的树形结构。</p>
<p>（4）更容易在组合体中加入对象构件，客户端不必因为加入了新的对象构件而改变原有的代码。</p>
<p>缺点：</p>
<p>（1）使设计变的更抽象，对象的业务规则如果很复杂，则实现组合模式具有很大的挑战性，而且不是所有办法都与叶子对象子类都有关联。</p>
<h1 id="十、装饰者模式"><a href="#十、装饰者模式" class="headerlink" title="十、装饰者模式"></a>十、装饰者模式</h1><h2 id="1-解释-9"><a href="#1-解释-9" class="headerlink" title="1.解释"></a>1.解释</h2><p>装饰者模式又名包装（Wrapper）模式。装饰者以对客户端透明的方式扩展对象的功能，是继承关系的一个替代方案。</p>
<p>大多数的装饰者模式实际上是半透明的装饰模式，这样的装饰模式也称作半装饰、半适配器模式。</p>
<h2 id="2-包含的角色-8"><a href="#2-包含的角色-8" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象构件角色（Component）：给出一个抽象接口，以规范准备接受附加责任的对象。</p>
<p>（2）具体构件角色（ConcreteComponent）：定义一个将要接收附加责任的类。</p>
<p>（3）装饰角色（Decorator）：持有一个构件（Component）对象的实例，并定义一个与抽象构件接口一致的接口。</p>
<p>（4）具体装饰角色（ConcreteDecorator）：负责给构件对象”贴上”附加的责任。</p>
<h2 id="3-使用场景分析及代码实现-8"><a href="#3-使用场景分析及代码实现-8" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-comment">//抽象界面构件类：抽象构件类，为了突出与模式相关的核心代码，对原有控件代码进行了大量的简化</span><br><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span></span><br><br>&#123;<br><br>       public  <span class="hljs-keyword">abstract</span> void display();<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//窗体类：具体构件类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Window</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span><br><br>&#123;<br><br>       public  void display()<br><br>       &#123;<br><br>              <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;显示窗体！&quot;</span>);<br><br>       &#125;<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//文本框类：具体构件类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TextBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span><br><br>&#123;<br><br>       public  void display()<br><br>       &#123;<br><br>              <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;显示文本框！&quot;</span>);<br><br>       &#125;<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//列表框类：具体构件类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListBox</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span><br><br>&#123;<br><br>       public  void display()<br><br>       &#123;<br><br>              <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;显示列表框！&quot;</span>);<br><br>       &#125;<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//构件装饰类：抽象装饰类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComponentDecorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span><br><br>&#123;<br><br>       <span class="hljs-keyword">private</span> <span class="hljs-type">Component</span> component;  <span class="hljs-comment">//维持对抽象构件类型对象的引用</span><br><br> <br><br>       public <span class="hljs-type">ComponentDecorator</span>(<span class="hljs-type">Component</span>  component)  <span class="hljs-comment">//注入抽象构件类型的对象</span><br><br>       &#123;<br><br>              <span class="hljs-keyword">this</span>.component = component;<br><br>       &#125;<br><br> <br><br>       public void display()<br><br>       &#123;<br><br>              component.display();<br><br>       &#125;<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//滚动条装饰类：具体装饰类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrollBarDecorator</span> <span class="hljs-keyword">extends</span>  <span class="hljs-title">ComponentDecorator</span></span><br><br>&#123;<br><br>       public <span class="hljs-type">ScrollBarDecorator</span>(<span class="hljs-type">Component</span>  component)<br><br>       &#123;<br><br>              <span class="hljs-keyword">super</span>(component);<br><br>       &#125;<br><br> <br><br>       public void display()<br><br>       &#123;<br><br>              <span class="hljs-keyword">this</span>.setScrollBar();<br><br>              <span class="hljs-keyword">super</span>.display();<br><br>       &#125;<br><br> <br><br>       public  void setScrollBar()<br><br>       &#123;<br><br>              <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;为构件增加滚动条！&quot;</span>);<br><br>       &#125;<br><br>&#125;<br><br> <br><br><span class="hljs-comment">//黑色边框装饰类：具体装饰类</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BlackBorderDecorator</span> <span class="hljs-keyword">extends</span>  <span class="hljs-title">ComponentDecorator</span></span><br><br>&#123;<br><br>       public <span class="hljs-type">BlackBorderDecorator</span>(<span class="hljs-type">Component</span>  component)<br><br>       &#123;<br><br>              <span class="hljs-keyword">super</span>(component);<br><br>       &#125;<br><br> <br><br>       public void display()<br><br>       &#123;<br><br>              <span class="hljs-keyword">this</span>.setBlackBorder();<br><br>              <span class="hljs-keyword">super</span>.display();<br><br>       &#125;<br><br> <br><br>       public  void setBlackBorder()<br><br>       &#123;<br><br>              <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;为构件增加黑色边框！&quot;</span>);<br><br>       &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span></span><br><br>&#123;<br><br>       public  static void main(<span class="hljs-type">String</span> args[])<br><br>       &#123;<br><br>              <span class="hljs-type">Component</span> component,componentSB;  <span class="hljs-comment">//使用抽象构件定义</span><br><br>              component = <span class="hljs-keyword">new</span> <span class="hljs-type">Window</span>(); <span class="hljs-comment">//定义具体构件</span><br><br>              componentSB = <span class="hljs-keyword">new</span>  <span class="hljs-type">ScrollBarDecorator</span>(component); <span class="hljs-comment">//定义装饰后的构件</span><br><br>              componentSB.display();<br><br>       &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-8"><a href="#4-优缺点分析-8" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>（1）装饰模式与继承关系的目的都是要扩展对象的功能，但是装饰模式可以提供比继承更多的灵活性。装饰模式允许系统动态决定“贴上”一个需要的“装饰”，或者除 掉一个不需要的“装饰”。继承关系则不同，继承关系是静态的，它在系统运行前就决定了。</p>
<p>（2）通过使用不同的具体装饰类以及这些装饰类的排列组合，设计师可以创造出很多不同行为的组合。<br>缺点：</p>
<p>使用装饰模式会产生比使用继承关系更多的对象。更多的对象会使得查错变得困难，特别是这些对象看上去都很相像。</p>
<h1 id="十一、外观模式"><a href="#十一、外观模式" class="headerlink" title="十一、外观模式"></a>十一、外观模式</h1><h2 id="1-解释-10"><a href="#1-解释-10" class="headerlink" title="1.解释"></a>1.解释</h2><p>外观模式（Facade Pattern）也称为过程模式，是结构性模式。外观模式为子系统的一组接口提供了一个一致的界面，此模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。外观模式可以理解为 为转换一群接口，客户只要调用这一个接口而不用调用多个接口才能达到目的，也不需要关心这个子系统的内部细节。就是解决多个复杂接口带来的使用困难，起到简化用户操作的作用。</p>
<h2 id="2-包含的角色-9"><a href="#2-包含的角色-9" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>Facade外观类：提供统一的调用接口，外观类知道哪些子系统负责处理请求，从而将调用端的请求代理给相应的子系统对象。</p>
<p>System子系统：处理Facade对象指派的任务，是功能的实际提供者。</p>
<p>Client客户端：外观接口调用测试者。</p>
<h2 id="3-使用场景分析及代码实现-9"><a href="#3-使用场景分析及代码实现-9" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//各子系统</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Player</span> &#123; <span class="hljs-comment">//播放器</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Player instance = <span class="hljs-keyword">new</span> Player();<span class="hljs-comment">//使用单例模式(饿汉式)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Player <span class="hljs-title">getInstanc</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 播放器打开了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 播放器关闭了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 播放器播放中 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 播放暂停 &quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Screen</span> &#123; <span class="hljs-comment">//屏幕</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Screen instance = <span class="hljs-keyword">new</span> Screen();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Screen <span class="hljs-title">getInstance</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">up</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 屏幕上升 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">down</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 屏幕下降 &quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Stereo</span> &#123; <span class="hljs-comment">//音响</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Stereo instance = <span class="hljs-keyword">new</span> Stereo();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Stereo <span class="hljs-title">getInstance</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 音响打开了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 音响关闭了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setVolume</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 音响音量调节 &quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Projector</span> &#123; <span class="hljs-comment">//投影仪</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Projector instance = <span class="hljs-keyword">new</span> Projector();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Projector <span class="hljs-title">getInstance</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 投影仪打开了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 投影仪关闭了 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">focus</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 投影仪聚焦 &quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">zoom</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot; 投影仪放大 &quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//外观类</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HomeTheaterFacade</span> &#123; <span class="hljs-comment">//外观类</span><br>    <span class="hljs-comment">//定义各个子系统对象</span><br>    <span class="hljs-keyword">private</span> Player player;<br>    <span class="hljs-keyword">private</span> Screen screen;<br>    <span class="hljs-keyword">private</span> Stereo stereo;<br>    <span class="hljs-keyword">private</span> Projector projector;<br><br>    <span class="hljs-comment">//构造器</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HomeTheaterFacade</span>()</span> &#123;<br>        <span class="hljs-keyword">this</span>.player = Player.getInstance();<br>        <span class="hljs-keyword">this</span>.screen = Screen.getInstance();<br>        <span class="hljs-keyword">this</span>.stereo = Stereo.getInstance();<br>        <span class="hljs-keyword">this</span>.projector = Projector.getInstance();<br><br>    &#125;<br><br>    <span class="hljs-comment">//一致界面</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ready</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;===ready===&quot;</span>);<br>        screen.down();<br>        player.<span class="hljs-keyword">on</span>();<br>        stereo.<span class="hljs-keyword">on</span>();<br>        stereo.setVolume();<br>        projector.<span class="hljs-keyword">on</span>();<br>        projector.zoom();<br>        projector.focus();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;===play===&quot;</span>);<br>        player.play();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pause</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;===pause===&quot;</span>);<br>        player.pause();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">end</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;===end===&quot;</span>);<br>        screen.up();<br>        projector.off();<br>        stereo.off();<br>        player.off();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span> &#123;<br>        HomeTheaterFacade homeTheaterFacade = <span class="hljs-keyword">new</span> HomeTheaterFacade();<br>        homeTheaterFacade.ready();<br>        homeTheaterFacade.play();<br>        homeTheaterFacade.pause();<br>        homeTheaterFacade.end();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-9"><a href="#4-优缺点分析-9" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>外观模式对客户端与子系统的耦合关系，让子系统内部的模块更易维护和扩展。</p>
<p>外观模式对外屏蔽了子系统的细节，因此外观模式降低了客户端对子系统使用的复杂性。</p>
<p>当系统需要进行分层设计的时候，可以考虑外观模式帮助我们更好的划分访问的层次。</p>
<p>不需要过多的或者不合理的使用外观模式，使用外观模式好，还是直接调用模块好。要让系统有层次，利于维护为目的。</p>
<p>在维护一个遗留的大型系统的时候，可能这个系统已经变的非常难以维护和扩展，此时可以考虑为新系统开发一个Facade类，来提供遗留系统的比较清晰简单的接口，让新系统与Facade类交互，提高复用性。</p>
<p>优点：</p>
<p>1）松耦合，用户和子系统解耦，屏蔽子系统；可以提高子系统的独立性。</p>
<p>2）使用简单，简化了用户与子系统的依赖关系，用户只与门面对接，有统一的入口；不需要知道所有子系统及内部构造。</p>
<p>缺点：</p>
<p>1）不规范的编程方式，没有面向抽象编程，而是通过增加中介层，转换服务提供方的服务接口。</p>
<p>最核心的目的：简化子系统，简化客户使用，屏蔽多个子系统。</p>
<h1 id="十二、轻量级模式"><a href="#十二、轻量级模式" class="headerlink" title="十二、轻量级模式"></a>十二、轻量级模式</h1><h2 id="1-解释-11"><a href="#1-解释-11" class="headerlink" title="1.解释"></a>1.解释</h2><p>轻量级模式又叫做享元模式，是对象池的一种标签。类似线程池，线程池可以避免不停地创建和销毁对象，消耗性能。享元模式可以减少对象的数量，其宗旨是共享细粒度对象，将多个对同一对象的访问集中起来，属于结构型设计模式。</p>
<h2 id="2-包含的角色-10"><a href="#2-包含的角色-10" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>抽象享元角色（IFlyweight）：享元对象抽象基类或接口，同时定义出对象的外部状态和内部状态的接口实现。</p>
<p>具体享元模式（ConcreteFlyWeight）：实现了抽象角色定义的业务。该角色的内部状态处理应该与环境无关，不会出现一个操作改变内部状态，同时修改了外部状态的情况。</p>
<p>享元工厂（FlyweightFactory）：负责管理享元对象池和创建享元对象。</p>
<h2 id="3-使用场景分析及代码实现-10"><a href="#3-使用场景分析及代码实现-10" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 抽象享元角色</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFlyweight</span> &#123;<br><br>    <span class="hljs-built_in">void</span> <span class="hljs-title function_">operation</span>(<span class="hljs-title class_">String</span> extrinsicState);<br><br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 具体享元角色</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteFlyweight</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFlyweight</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> intrinsicState;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">ConcreteFlyweight</span>(<span class="hljs-title class_">String</span> intrinsicState) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">intrinsicState</span> = intrinsicState;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">operation</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> extrinsicState</span>) &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;object address: &quot;</span> + <span class="hljs-title class_">System</span>.<span class="hljs-title function_">identityHashCode</span>(<span class="hljs-variable language_">this</span>));<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;extrinsicState: &quot;</span> + extrinsicState);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;intrinsicState: &quot;</span> + intrinsicState);<br>    &#125;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 享元工厂</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyweightFactory</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">IFlyweight</span>&gt; pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">IFlyweight</span> <span class="hljs-title function_">getFlyweight</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> intrinsicState</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!pool.<span class="hljs-title function_">containsKey</span>(intrinsicState)) &#123;<br>            <span class="hljs-title class_">IFlyweight</span> flyweight = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteFlyweight</span>(intrinsicState);<br>            pool.<span class="hljs-title function_">put</span>(intrinsicState, flyweight);<br>        &#125;<br>        <span class="hljs-keyword">return</span> pool.<span class="hljs-title function_">get</span>(intrinsicState);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-title class_">String</span>[] args</span>) &#123;<br>        <span class="hljs-title class_">IFlyweight</span> flyweight1 = <span class="hljs-title class_">FlyweightFactory</span>.<span class="hljs-title function_">getFlyweight</span>(<span class="hljs-string">&quot;aa&quot;</span>);<br>        <span class="hljs-title class_">IFlyweight</span> flyweight2 = <span class="hljs-title class_">FlyweightFactory</span>.<span class="hljs-title function_">getFlyweight</span>(<span class="hljs-string">&quot;aa&quot;</span>);<br>        <span class="hljs-title class_">IFlyweight</span> flyweight3 = <span class="hljs-title class_">FlyweightFactory</span>.<span class="hljs-title function_">getFlyweight</span>(<span class="hljs-string">&quot;cc&quot;</span>);<br>        flyweight1.<span class="hljs-title function_">operation</span>(<span class="hljs-string">&quot;wwwww&quot;</span>);<br>        flyweight2.<span class="hljs-title function_">operation</span>(<span class="hljs-string">&quot;ttttt&quot;</span>);<br>        flyweight3.<span class="hljs-title function_">operation</span>(<span class="hljs-string">&quot;wwwww&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-10"><a href="#4-优缺点分析-10" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：减少对象的创建，降低内存中对象的数量，降低系统内存，提高系统性能。</p>
<p>缺点：</p>
<p>1）需要关注内、外部状态，关注线程安全问题（同时访问相同的缓存）</p>
<p>2）系统程序负责化了</p>
<h1 id="十三、代理模式"><a href="#十三、代理模式" class="headerlink" title="十三、代理模式"></a>十三、代理模式</h1><h2 id="1-解释-12"><a href="#1-解释-12" class="headerlink" title="1.解释"></a>1.解释</h2><p>由于某些原因需要给某对象提供一个代理以控制对该对象的访问。这时，访问对象不适合或者不能直接引用目标对象，代理对象作为访问对象和目标对象之间的中介。</p>
<h2 id="2-包含的角色-11"><a href="#2-包含的角色-11" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1）抽象主题角色（Subject）：声明了目标对象和代理对象的共同接口，这样一来在任何可以使用目标对象的地方都可以使用代理对象。</p>
<p>2）具体主题对象（RealSubject）：也称为委托角色或者被代理角色。定义了代理对象所代表的目标对象。</p>
<p>3）代理主题角色（Proxy）：也叫委托类、代理类。代理对象内部含有目标对象的引用，从而可以在任何时候操作目标对象；代理对象提供一个与目标对象相同的接口，以便可以在任何时候替代目标对象。</p>
<h2 id="3-使用场景分析及代码实现-11"><a href="#3-使用场景分析及代码实现-11" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//抽象主题角色</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-built_in">void</span> <span class="hljs-title function_">operate</span>();<br>&#125;<br><span class="hljs-comment">//具体主题角色</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealSubject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">operate</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;RealSubject&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//代理类</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Proxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Subject</span> subject = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">operate</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(subject == <span class="hljs-literal">null</span>)<br>            subject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RealSubject</span>();<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">print</span>(<span class="hljs-string">&quot;I&#x27;m Proxy, I&#x27;m invoking...&quot;</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subject</span>.<span class="hljs-title function_">operate</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//测试代码</span><br>        <span class="hljs-title class_">Subject</span> subject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>();<br>        subject.<span class="hljs-title function_">operate</span>();<br><span class="hljs-comment">//动态代理</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate1</span>();<br>    <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate2</span>();<br>    <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate3</span>();<br>    <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate4</span>();<br>    <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate5</span>();<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealSubject1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate1</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject-operate1()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate2</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject-operate2()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate3</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject-operate3()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate4</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject-operate4()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate5</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject-operate5()&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealSubject2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate1</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject2-operate1()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate2</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject2-operate2()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate3</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject2-operate3()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate4</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject2-operate4()&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operate5</span>(<span class="hljs-params"></span>)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;RealSubject2-operate5()&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span><br>&#123;<br>    <span class="hljs-title class_">Object</span> obj = <span class="hljs-literal">null</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">newProxyInstance</span>(<span class="hljs-params"><span class="hljs-title class_">Object</span> realObj</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span> = realObj;<br>        <span class="hljs-title class_">Class</span>&lt;?&gt; classType = <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>.<span class="hljs-title function_">getClass</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Proxy</span>.<span class="hljs-title function_">newProxyInstance</span>(classType.<span class="hljs-title function_">getClassLoader</span>(), classType.<span class="hljs-title function_">getInterfaces</span>(), <span class="hljs-variable language_">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-title class_">Object</span> proxy, <span class="hljs-title class_">Method</span> method, <span class="hljs-title class_">Object</span>[] args) throws <span class="hljs-title class_">Throwable</span><br>    &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">print</span>(<span class="hljs-string">&quot;I&#x27;m Proxy, I&#x27;m invoking...&quot;</span>);<br>        <span class="hljs-title class_">Object</span> <span class="hljs-built_in">object</span> = method.<span class="hljs-title function_">invoke</span>(obj, args);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-built_in">object</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">object</span>;<br>    &#125;<br>&#125;<br>        <span class="hljs-title class_">Subject</span> <span class="hljs-built_in">object</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RealSubject</span>();<br>        <span class="hljs-title class_">Subject</span> subject = (<span class="hljs-title class_">Subject</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxyHandler</span>().<span class="hljs-title function_">newProxyInstance</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RealSubject</span>());<br>        <span class="hljs-title class_">Subject</span> subject2 = (<span class="hljs-title class_">Subject</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxyHandler</span>().<span class="hljs-title function_">newProxyInstance</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RealSubject2</span>());<br>        subject.<span class="hljs-title function_">operate2</span>();<br>        subject2.<span class="hljs-title function_">operate4</span>();<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-11"><a href="#4-优缺点分析-11" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1）代理模式在客户端与目标对象之间起到一个中介作用和保护目标对象的作用</p>
<p>2）代理对象可以扩展目标对象的功能</p>
<p>3）代理模式能将客户端与目标对象进行分离，在一定程度上降低了系统的耦合度。</p>
<p>缺点：<br>在客户端和目标对象之间增加了一个代理对象，会造成请求处理速度变慢</p>
<p>增加了系统的复杂度</p>
<h1 id="十四、责任链模式（职责链模式）"><a href="#十四、责任链模式（职责链模式）" class="headerlink" title="十四、责任链模式（职责链模式）"></a>十四、责任链模式（职责链模式）</h1><h2 id="1-解释-13"><a href="#1-解释-13" class="headerlink" title="1.解释"></a>1.解释</h2><p>在现实生活中，一个事件需要经过多个处理对象处理是常见的场景，例如，采购审批流程、请假流程等。公司员工请假，可批假的领导有部分负责人、副总经理、总经理等，但每个领导能批准的天数不同，员工必须根据需要请假的天数去找不同的领导签名，也就是说员工必须记住每个领导的姓名、电话和地址等信息，这无疑增加了难度。</p>
<p>在计算机软硬件中也有相关的例子，如总线网中数据报传送，每台计算机根据目标地址是否同自己的地址相同来决定是否接收；还有异常处理中，处理程序根据异常的类型决定自己是否能处理该异常；还有Struts2的拦截器、JSP和Servlet的Filter等，所有这些，都可以考虑使用责任链模式来实现。</p>
<p>定义：为了避免请求发送者与多个请求处理者耦合在一起，于是将所有的请求的处理者通过前一对象记住其下一个对象的引用而连成一条链；当有请求发生时，可将请求沿着这条链传递，直到有对象处理它为止。</p>
<h2 id="2-包含的角色-12"><a href="#2-包含的角色-12" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象处理者（Handler）角色：定义一个处理请求的接口，包含抽象处理方法和一个后继连接。</p>
<p>2.具体处理者（Concrete Handler）角色：实现抽象处理者的处理方法，判断能否处理本次请求，如果可以处理请求则处理，否则将该请求转给它的后继者。</p>
<p>3.客户类（Client）角色：创建处理链，并向链头的具体处理者对象提交请求，它不关心处理细节和请求的传递过程。</p>
<p>责任链模式的本质是<strong>解耦请求与处理</strong>，让请求在处理链中能进行传递与被处理；理解责任链模式应当理解其模式，而不是其具体实现。责任链模式的独到之处是将其节点处理者组合成了链式结构，并允许节点自身决定是否进行请求处理或转发，相当于让请求流动起来。</p>
<h2 id="3-使用场景及代码实现"><a href="#3-使用场景及代码实现" class="headerlink" title="3.使用场景及代码实现"></a>3.使用场景及代码实现</h2><p>责任链模式的实现代码</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象处理者角色</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Handler</span>&#123;<br>    <span class="hljs-keyword">private</span> Handler next;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setNext</span>(<span class="hljs-params">Handler next</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.next = next;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Handler <span class="hljs-title">getNext</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> next;<br>    &#125;<br>    <span class="hljs-comment">//处理请求的方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">String request</span>)</span>;<br>&#125;<br><span class="hljs-comment">//具体处理者角色</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteHandler1</span> <span class="hljs-title">extends</span> <span class="hljs-title">Handler</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">String request</span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(request.<span class="hljs-keyword">equals</span>(<span class="hljs-string">&quot;one&quot;</span>))&#123;<br>            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体处理者1负责处理该请求！&quot;</span>);<br>			&#125;<span class="hljs-keyword">else</span>&#123;<br>            	<span class="hljs-keyword">if</span>(getNext() != <span class="hljs-literal">null</span>)&#123;<br>                    getNext().handleRequest(request);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;没有人处理该请求！&quot;</span>)<br>                &#125;<br>        	&#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteHandler2</span> <span class="hljs-title">extends</span> <span class="hljs-title">Handler</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">String request</span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(request.<span class="hljs-keyword">equals</span>(<span class="hljs-string">&quot;two&quot;</span>))&#123;<br>            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体处理者2负责处理该请求！&quot;</span>);<br>			&#125;<span class="hljs-keyword">else</span>&#123;<br>            	<span class="hljs-keyword">if</span>(getNext() != <span class="hljs-literal">null</span>)&#123;<br>                    getNext().handleRequest(request);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;没有人处理该请求！&quot;</span>)<br>                &#125;<br>        	&#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ChainOfResponsibilityPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        <span class="hljs-comment">//组装责任链</span><br>        Handler handler1 = <span class="hljs-keyword">new</span> ConcreteHandler1();<br>        Handler handler2 = <span class="hljs-keyword">new</span> ConcreteHandler2();<br>        handler1.setNext(handler2);<br>        <span class="hljs-comment">//提交请求</span><br>        handler1.handleRequest(<span class="hljs-string">&quot;two&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//运行结果如下</span><br>具体处理者<span class="hljs-number">2</span>负责处理该请求<br></code></pre></td></tr></table></figure>

<p>在上面代码中，我们把消息硬编码为String类型，而在真实业务中，消息是具备多样性的，可以是int、String或者自定义类型。因此，在上面代码的基础上，可以对消息类型进行抽象request，增强了消息的兼容性。</p>
<p>应用实例：</p>
<p>假如规定学生请假小于或等于 2 天，班主任可以批准；小于或等于 7 天，系主任可以批准；小于或等于 10 天，院长可以批准；其他情况不予批准。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-comment">//学生请假条审批</span><br><span class="hljs-comment">//抽象处理者：领导类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Leader</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Leader</span> next;<br>    public void setNext(<span class="hljs-type">Leader</span> next)&#123;<br>        <span class="hljs-keyword">this</span>.next = next;<br>    &#125;<br>    public <span class="hljs-type">Leader</span> getNext()&#123;<br>        <span class="hljs-keyword">return</span> next;<br>    &#125;<br>    <span class="hljs-comment">//处理请求的方法</span><br>    public <span class="hljs-keyword">abstract</span> void handleRequest(int <span class="hljs-type">LeaveDays</span>);<br>&#125;<br><span class="hljs-comment">//具体处理者1：班主任类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClassAdviser</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Leader</span></span>&#123;<br>    public void handleRequest(int <span class="hljs-type">LeaveDays</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-type">LeaveDays</span> &lt;= <span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;班主任批准你请假&quot;</span>+<span class="hljs-type">LeaveDays</span>+<span class="hljs-string">&quot;天。&quot;</span>)<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(getNext() != <span class="hljs-literal">null</span>)&#123;<br>                getNext().handleRequest(<span class="hljs-type">LeaveDays</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;请假天数太多，没有人批准该假条！&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体处理类2：系主任类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DepartmentHead</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Leader</span></span>&#123;<br>    public void handleRequest(int <span class="hljs-type">LeaveDays</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-type">LeaveDays</span> &lt;= <span class="hljs-number">7</span>)&#123;<br>            <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;系主任批准你请假&quot;</span>+<span class="hljs-type">LeaveDays</span>+<span class="hljs-string">&quot;天。&quot;</span>)<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(getNext()!=<span class="hljs-literal">null</span>)&#123;<br>                getNext().handleRequest(<span class="hljs-type">LeaveDays</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;请假天数太多，没有人批准该假条！&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体处理者类3：院长类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bean</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Leader</span></span>&#123;<br>    public void handleRequest(int <span class="hljs-type">LeaveDays</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-type">LeaveDays</span> &lt;= <span class="hljs-number">10</span>)&#123;<br>            <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;院长批准你请假&quot;</span>+<span class="hljs-type">LeaveDays</span>+<span class="hljs-string">&quot;天。&quot;</span>)<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(getNext() != <span class="hljs-literal">null</span>)&#123;<br>                getNext().handleRequest(<span class="hljs-type">LeaveDays</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;请假天数太多，没有人批准该假条！&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体处理类4：教务处长类</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeanOfStudies</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Leader</span></span>&#123;<br>    public void handleRequest(int <span class="hljs-type">LeaveDays</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-type">LeaveDays</span> &lt;= <span class="hljs-number">20</span>)&#123;<br>            <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;教务处长批注你请假&quot;</span>+<span class="hljs-type">LeaveDays</span>+<span class="hljs-string">&quot;天。&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(getNext() != <span class="hljs-literal">null</span>)&#123;<br>                getNext().handleRequest(<span class="hljs-type">LeaveDays</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;请假天数太多，没有人批准该假条！&quot;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-12"><a href="#4-优缺点分析-12" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>通常情况下，可以通过数据链表来实现职责链模式的数据结构。</p>
<p>应用场景：</p>
<p>1、多个对象可以处理一个请求，但具体由哪个对象处理该请求在运行时自动确定。</p>
<p>2、可动态指定一组对象处理请求，或添加新的处理者。</p>
<p>3、需要在不明确指定请求处理者的情况下，向多个处理者中的一个提交请求。</p>
<p>优点：</p>
<p>1.降低了对象之间的耦合度。该模式使得一个对象无须知道到底是哪一个对象处理其请求以及链的结构，发送者和接收者也无须拥有对方的明确信息。</p>
<p>2.增强了系统的可扩展性。可以根据需要增加新的请求处理类，满足开闭原则。</p>
<p>3.增强了给对象指派职责的灵活性。当工作流程发生变化，可以动态的改变链内的成员或者调用它们的次序，也可动态的新增或者删除责任。</p>
<p>4.责任链简化了对象之间的连接。每个对象只需保持一个指向其后继者的引用，不需保持其他所有处理者的引用，这避免了使用众多的if或者if…else语句。</p>
<p>5.责任分担。每个类只需要处理自己该处理的工作，不该处理的传递给下一个对象完成，明确各类的责任范围，符合类的单一职责原则。</p>
<p>缺点：<br>1.不能保证每个请求一定被处理。由于一个请求没有明确的接收者，所以不能保证它一定会被处理，该请求可能一直传到链的末端都得不到处理。</p>
<p>2.对于较长的责任链，请求的处理可能涉及多个处理对象，系统性能将受到一定影响。</p>
<p>3.职责链建立的合理性要靠客户端来保证，增加了客户端的复杂性，可能会由于职责链的错误设置而导致系统出错，如可能会造成循环调用。</p>
<h1 id="十五、命令模式"><a href="#十五、命令模式" class="headerlink" title="十五、命令模式"></a>十五、命令模式</h1><h2 id="1-解释-14"><a href="#1-解释-14" class="headerlink" title="1.解释"></a>1.解释</h2><p>在软件开发系统中，”方法的请求者”和”方法的实现者”之间经常存在紧密的耦合关系，这不利于软件功能的扩展与维护。例如，想对方法进行”撤销、重做、记录”等处理都很不方便，因此，如何将方法的请求者与实现者解耦？</p>
<p>在现实生活中，命令模式的例子也很多。比如看电视时，我们只需要轻轻一按遥控器就能完成频道的切换，这就是命令模式，将换台请求和换台处理完全解耦了。电视机遥控器（命令发送者）通过按钮（具体命令）来遥控电视机（命令接收者）。</p>
<p>定义：将一个请求封装为一个对象，使发出请求的责任和执行请求的责任分割开。这样两者之间通过命令进行沟通，这样方便将命令对象进行存储、传递、调用、增加与管理。</p>
<h2 id="2-包含的角色-13"><a href="#2-包含的角色-13" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象命令类（Command）角色：声明执行命令的接口，拥有执行命令的抽象方法execute()。</p>
<p>2.具体命令类（Concrete Command）角色：是抽象命令类的具体实现类，它拥有接收者对象，并通过调用接收者的功能来完成命令要执行的操作。</p>
<p>3.实现者&#x2F;接收者（Receiver）角色：执行命令功能的相关操作，是具体命令对象业务的真正实现者。</p>
<p>4.调用者&#x2F;请求者（Invoker）角色：是请求的发送者，他通常拥有很多的命令对象，并通过访问命令对象来执行相关请求，它不直接访问接收者。</p>
<h2 id="3-使用场景及代码实现-1"><a href="#3-使用场景及代码实现-1" class="headerlink" title="3.使用场景及代码实现"></a>3.使用场景及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//调用者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Invoker</span>&#123;<br>    <span class="hljs-keyword">private</span> Command command;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Invoker</span>(<span class="hljs-params">Command command</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.command = command;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCommand</span>(<span class="hljs-params">Command command</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.command = command;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">call</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;调用者执行命令command...&quot;</span>);<br>        command.execute();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象命令</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Command</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体命令</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteCommand</span> <span class="hljs-title">implement</span> <span class="hljs-title">Command</span>&#123;<br>    <span class="hljs-keyword">private</span> Receiver receiver;<br>    ConcreteCommand()&#123;<br>        receiver = <span class="hljs-keyword">new</span> Receiver();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span>()</span>&#123;<br>        receiver.action();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//接收者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Receiver</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">action</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;接收者的action()方法被调用...&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CommandPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Command cmd = <span class="hljs-keyword">new</span> ConcreteCommand();<br>        Invoker ir = <span class="hljs-keyword">new</span> Invoker(cmd);<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;客户访问调用者的call()方法...&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//结果</span><br>客户访问调用者的call()方法...<br>调用者执行命令command...<br>接收者的action()方法被调用...<br></code></pre></td></tr></table></figure>

<p>应用实例：</p>
<p>命令模式实现客户去餐馆吃早餐</p>
<p>分析：客户去餐馆可选择的早餐有肠粉、河粉和馄饨等，客户可向服务员选择以上早餐中的若干种，服务员将客户的请求交给相关的厨师去做。这里的点早餐相当于“命令”，服务员相当于“调用者”，厨师相当于“接收者”，所以用命令模式实现比较合适。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//调用者：服务员</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Waiter</span>&#123;<br>    <span class="hljs-keyword">private</span> Breakfast changFen,hunTun,heFen;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setChangFen</span>(<span class="hljs-params">Breakfast f</span>)</span>&#123;<br>        changFen = f;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHunTun</span>(<span class="hljs-params">Breakfast f</span>)</span>&#123;<br>        hunTun = f;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHeFen</span>(<span class="hljs-params">Breakfast f</span>)</span>&#123;<br>        heFen = f;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chooseHunTun</span>()</span>&#123;<br>        hunTun.cooking();<br>    &#125;<br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chooseChangFen</span>()</span>&#123;<br>        changFen.cooking();<br>    &#125;<br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chooseHeFen</span>()</span>&#123;<br>        heFen.cooking();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象命令：早餐</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Breakfast</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体命令：肠粉</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ChangFen</span> <span class="hljs-title">implements</span> <span class="hljs-title">Breakfast</span>&#123;<br>    <span class="hljs-keyword">private</span> ChangFenChef receiver;<br>    ChangFen()&#123;<br>        receiver = <span class="hljs-keyword">new</span> ChangFenChef();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>        receiver.cooking();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体命令：馄饨</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">HunTun</span> <span class="hljs-title">implements</span> <span class="hljs-title">Breakfast</span>&#123;<br>    <span class="hljs-keyword">private</span> HunTunChef receiver;<br>    HunTun()&#123;<br>        receiver = <span class="hljs-keyword">new</span> HunTunChef();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>        receiver.cooking();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体命令：河粉</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">HeFen</span> <span class="hljs-title">implements</span> <span class="hljs-title">Breakfast</span>&#123;<br>    <span class="hljs-keyword">private</span> HeFenChef receiver;<br>    HeFen()&#123;<br>        receiver = <span class="hljs-keyword">new</span> HeFenChef();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>        receiver.cooking();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//接收者：肠粉厨师</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ChangFenChef</span>&#123;<br>    ChangFenChef()&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;肠粉厨师&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>         System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;在做肠粉...&quot;</span>);<br>	&#125;<br>&#125;<br><span class="hljs-comment">//接收者：馄饨厨师</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">HunTunChef</span>&#123;<br>    HunTunChef()&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;馄饨厨师&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>         System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;在做馄饨...&quot;</span>);<br>	&#125;<br>&#125;<br><span class="hljs-comment">//接收者：河粉厨师</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">HeFenChef</span>&#123;<br>    HeFenChef()&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;河粉厨师&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cooking</span>()</span>&#123;<br>         System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;在做河粉...&quot;</span>);<br>	&#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CookingCommand</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Breakfast food1 = <span class="hljs-keyword">new</span> ChangFen();<br>        Breakfast food2 = <span class="hljs-keyword">new</span> HunTun();<br>        Breakfast food3 = <span class="hljs-keyword">new</span> HeFen();<br>        Waiter waiter = <span class="hljs-keyword">new</span> Waiter();<br>        waiter.setChangFen(food1);<span class="hljs-comment">//设置肠粉菜单</span><br>        waiter.setHunTun(food2);<span class="hljs-comment">//设置馄饨菜单</span><br>        waiter.setHeFen(food3);<span class="hljs-comment">//设置河粉菜单</span><br>        waiter.chooseChangFen();<span class="hljs-comment">//选择肠粉</span><br>        waiter.chooseHunTun();<span class="hljs-comment">//选择馄饨</span><br>        waiter.chooseHeFen();<span class="hljs-comment">//选择河粉</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>应用场景：</p>
<p>当系统的某项操作具备命令语义，且命令实现不稳定（变化）时，可以通过命令模式解耦请求与实现。使用抽象命令接口使请求方的代码架构稳定，封装接收方具体命令的实现细节。接收方与抽象命令呈现弱耦合（内部方法无需一致），具备良好的扩展性。</p>
<p>通常适用于以下场景：</p>
<p>1.请求调用者需要与请求接收者解耦时，命令模式可以使调用者和接收者不直接交互。</p>
<p>2.系统随机请求命令或经常增加、删除命令时，命令模式可以方便的实现这些功能。</p>
<p>3.当系统需要执行一组操作时，命令模式可以定义宏命令来实现该功能。</p>
<p>4.当系统需要支持命令的撤销（Undo）操作和恢复（Redo）操作时，可以将命令对象存储起来，采用备忘录模式来实现。</p>
<h2 id="4-优缺点分析-13"><a href="#4-优缺点分析-13" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1.通过引入中间件（抽象接口）降低系统的耦合度。</p>
<p>2.扩展性良好，增加或删除命令非常方便。采用命令模式增加与删除命令不会影响其他类，且满足“开闭原则”。</p>
<p>3.可以实现宏命令。命令模式可以与组合模式结合，将多个命令装配成一个组合命令，即宏命令。</p>
<p>4.方便实现Undo和Redo操作。命令模式可以与后面介绍的备忘录模式结合，实现命令的撤销与恢复。</p>
<p>5.可以在现有命令的基础上，增加额外功能。比如日志记录，结合装配器模式会更加灵活。</p>
<p>缺点：</p>
<p>1.可能产生大量具体的命令类。因为每一个操作都需要设计一个具体命令类，这会增加系统的复杂性。</p>
<p>2.命令模式的结果其实就是接收方的执行结果，但是为了以命令的形式进行架构、解耦请求与实现，引入了额外的类型结构（引入了请求方与抽象命令接口），增加了理解上的困难。不过这也是设计模式的通病，抽象必然会额外增加类的数量，代码抽离肯定比代码聚合更加难理解。</p>
<h1 id="十六、解释器模式"><a href="#十六、解释器模式" class="headerlink" title="十六、解释器模式"></a>十六、解释器模式</h1><h2 id="1-解释-15"><a href="#1-解释-15" class="headerlink" title="1.解释"></a>1.解释</h2><p>定义：给分析对象定义一种语言，并定义该语言的文法表示，再设计一个解释器来解释语言中的句子。也就是说，用编译语言的方式来分析应用中的实例。这种模式实现了文法表达式处理的接口，该接口解释一个特定的上下文。</p>
<h2 id="2-包含的角色-14"><a href="#2-包含的角色-14" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象表达式（Abstract Expression）角色：定义解释器的接口，约定解释器的解释操作，主要包含解释方法interpret()。</p>
<p>2.终结符表达式（Terminal Expression）角色：是抽象表达式的子类，用来实现文法中与终结符相关的操作，文法中的每一个操作符都有一个具体终结表达式与之相对应。</p>
<p>3.非终结符表达式（Nonterminal Expression）角色：也是抽象表达式的子类，用来实现文法中与非终结符相关的操作，文法中的每条规则都对应于一个非终结符表达式。</p>
<p>4.环境（Context）角色：通常包含各个解释器需要的数据或是公共的功能，一般用来传递被所有解释器共享的数据，后面的解释器可以从这里获取这些值。</p>
<p>5.客户端（Client）：主要任务是将需要分析的句子或表达式转换成使用解释器对象描述的抽象语法树，然后调用解释器的解释方法，当然也可以通过环境角色间接访问解释器的解释方法。</p>
<h2 id="3-使用场景分析及代码实现-12"><a href="#3-使用场景分析及代码实现-12" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><p>应用实例：</p>
<p>用解释器模式设计一个“韶粵通”公交车卡的读卡器程序。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//抽象表达式类</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Expression</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">interpret</span>(<span class="hljs-title class_">String</span> info);<br>&#125;<br><span class="hljs-comment">//终结符表达式类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TerminalExpression</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Expression</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">String</span>&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;<span class="hljs-title class_">String</span>&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">TerminalExpression</span>(<span class="hljs-title class_">String</span>[] data)&#123;<br>        <span class="hljs-keyword">for</span>(int i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++)<br>             set.<span class="hljs-title function_">add</span>(data[i]);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">interpret</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> info</span>)&#123;<br>        <span class="hljs-keyword">if</span>(set.<span class="hljs-title function_">contains</span>(info))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//非终结符表达式</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndExpression</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Expression</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Expression</span> city = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Expression</span> person = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">AndExpression</span>(<span class="hljs-title class_">Expression</span> city,<span class="hljs-title class_">Expression</span> person)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">city</span> = city;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">person</span> = person;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">interpret</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> info</span>)&#123;<br>        <span class="hljs-title class_">String</span> s[] = info.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;的&quot;</span>);<br>        <span class="hljs-keyword">return</span> city.<span class="hljs-title function_">interpret</span>(s[<span class="hljs-number">0</span>]) &amp;&amp; person.<span class="hljs-title function_">interpret</span>(s[<span class="hljs-number">1</span>]);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//环境类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Context</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span>[] citys = &#123;<span class="hljs-string">&quot;韶关&quot;</span>，<span class="hljs-string">&quot;广州&quot;</span>&#125;;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span>[] persons = &#123;<span class="hljs-string">&quot;老人&quot;</span>，<span class="hljs-string">&quot;妇女&quot;</span>，<span class="hljs-string">&quot;儿童&quot;</span>&#125;;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Expression</span> cityPerson;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Context</span>()&#123;<br>        <span class="hljs-title class_">Expression</span> city = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(citys);<br>        <span class="hljs-title class_">Expression</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>(persons);<br>        cityPerson = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AndExpression</span>(city,person);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">freeRide</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> info</span>)&#123;<br>        <span class="hljs-built_in">boolean</span> ok = cityPerson.<span class="hljs-title function_">interpret</span>(info);<br>        <span class="hljs-keyword">if</span>(ok)<br>            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;您是&quot;</span> + info + <span class="hljs-string">&quot;，您本次乘车免费！&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(info + <span class="hljs-string">&quot;，您不是免费人员，本次乘车扣费2元！&quot;</span>)<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterpreterPatternDemo</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-title class_">String</span>[] args</span>)&#123;<br>        <span class="hljs-title class_">Context</span> bus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>();<br>        bus.<span class="hljs-title function_">freeRide</span>(<span class="hljs-string">&quot;韶关的老人&quot;</span>);<br>		bus.<span class="hljs-title function_">freeRide</span>(<span class="hljs-string">&quot;韶关的年轻人&quot;</span>);<br>        bus.<span class="hljs-title function_">freeRide</span>(<span class="hljs-string">&quot;广州的妇女&quot;</span>);<br>        bus.<span class="hljs-title function_">freeRide</span>(<span class="hljs-string">&quot;广州的儿童&quot;</span>);<br>        bus.<span class="hljs-title function_">freeRide</span>(<span class="hljs-string">&quot;山东的儿童&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//结果</span><br>您是韶关的老人，您本次乘车免费！<br>韶关的年轻人，您不是免费人员，本次乘车扣费<span class="hljs-number">2</span>元！<br>您是广州的妇女，您本次乘车免费！<br>您是广州的儿童，您本次乘车免费！<br>山东的儿童，您不是免费人员，本次乘车扣费<span class="hljs-number">2</span>元！<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-14"><a href="#4-优缺点分析-14" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>应用场景：</p>
<p>1.当语言的文法较为简单，且执行效率不是关键问题时。</p>
<p>2.当问题重复出现，且可以用一种简单的语言来进行表达时。</p>
<p>3.当一个语言需要解释执行，并且语言中的句子可以表示为一个抽象语法树的时候，如XML文档解释。</p>
<p>注意：解释器模式在实际的软件开发中使用比较少，因为它会引起效率、性能以及维护等问题。</p>
<p>优点：</p>
<p>1.扩展性好。由于在解释器模式中使用类来表示语言的文法规则，因此可以通过继承等机制来改变或扩展文法。</p>
<p>2.容易实现。在语法树中的每个表达式节点类都是相似的，所以实现其文法较为容易。</p>
<p>缺点：</p>
<p>1.执行效率较低。解释器模式中通常使用大量的循环和递归调用，当要解释的句子较复杂时，其运行速度很慢，且代码的调试过程也比较麻烦。</p>
<p>2.会引起类膨胀。解释器模式中的每条规则至少需要定义一个类，当包含的文法规则很多时，类的个数将急剧增加，导致系统难以管理和维护。</p>
<p>3.可应用的场景比较少。在软件开发中，需要定义语言文法的应用实例非常少，所以这种模式很少被使用到。</p>
<h1 id="十七、迭代器模式"><a href="#十七、迭代器模式" class="headerlink" title="十七、迭代器模式"></a>十七、迭代器模式</h1><h2 id="1-解释-16"><a href="#1-解释-16" class="headerlink" title="1.解释"></a>1.解释</h2><p>在现实生活以及程序设计中，经常要访问一个聚合对象中的各个元素，如“数据结构”中的链表遍历，通常的做法是将链表的创建和遍历都放在同一个类中，但这种方式不利于程序的扩展，如果要更换遍历方法就必须修改程序源代码，这违背了“开闭原则”。</p>
<p>既然将遍历方法封装在聚合类中不可取，那么聚合类中不提供遍历方法，将遍历方法由用户自己实现是否可行呢？答案是同样不可取，因为这种方式会存在两个缺点：</p>
<p>1.暴露了聚合类的内部表示，使其数据不安全。</p>
<p>2.增加了客户的负担。</p>
<p>“迭代器模式”能较好的克服以上缺点，它在客户访问类与聚合类之间插入一个迭代器，这分离了聚合对象与其遍历行为，对客户也隐藏了其内部细节，且满足“单一职责原则”和“开闭原则”，比如java中的Collection、List、Set、Map等都包含了迭代器。</p>
<p>迭代器模式在生活中应用的比较广泛，比如：物流系统中的传送带，不管传送什么的是什么物品，都会被打包成一个个箱子，并且有一个统一的二维码。这样我们不需要关心箱子里是什么，在分发时只需要一个个检查发送的目的地即可。</p>
<h2 id="2-包含的角色-15"><a href="#2-包含的角色-15" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象聚合（Aggregate）角色：定义存储、添加、删除聚合对象以及创建迭代器对象的接口。</p>
<p>2.具体聚合（ConcreteAggregate）角色：实现抽象聚合类，返回一个具体迭代器的实例。</p>
<p>3.抽象迭代器（Iterator）角色：定义访问和遍历聚合元素的接口，通常包含hasNext()、first()、next()等方法。</p>
<p>4.具体迭代器（ConcreteIterator）角色：实现抽象迭代器接口中所定义的方法，完成对聚合对象的遍历，记录遍历的当前位置。</p>
<h2 id="3-使用场景分析及代码实现-13"><a href="#3-使用场景分析及代码实现-13" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象聚合</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Aggregate</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params">Object obj</span>)</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span>(<span class="hljs-params">Object obj</span>)</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Iterator <span class="hljs-title">getIterator</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体聚合</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteAggregate</span> <span class="hljs-title">implements</span> <span class="hljs-title">Aggregate</span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;Object&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params">Object obj</span>)</span>&#123;<br>        list.<span class="hljs-keyword">add</span>(obj);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span>(<span class="hljs-params">Object obj</span>)</span>&#123;<br>        list.<span class="hljs-keyword">remove</span>(obj);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Iterator <span class="hljs-title">getIterator</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> ConcreteIterator(list));<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象迭代器</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Iterator</span>&#123;<br>    <span class="hljs-function">Object <span class="hljs-title">first</span>()</span>;<br>    <span class="hljs-function">Object <span class="hljs-title">next</span>()</span>;<br>    <span class="hljs-function">boolean <span class="hljs-title">hasNext</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体迭代器</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteIterator</span> <span class="hljs-title">implements</span> <span class="hljs-title">Iterator</span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; list = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> index = <span class="hljs-number">-1</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteIterator</span>(<span class="hljs-params">List&lt;Object&gt; list</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.list = list;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> boolean <span class="hljs-title">hasNext</span>()</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &lt; list.size() <span class="hljs-number">-1</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>	&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">first</span>()</span>&#123;<br>        index = <span class="hljs-number">0</span>;<br>        Object obj = list.<span class="hljs-keyword">get</span>(index);<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">next</span>()</span>&#123;<br>        Object obj = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.hasNext())&#123;<br>            obj = list.<span class="hljs-keyword">get</span>(++index);<br>        &#125;<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IteratorPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Aggregate ag = <span class="hljs-keyword">new</span> ConcreteAggregate();<br>        ag.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;中山大学&quot;</span>);<br>		ag.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;华南理工&quot;</span>);<br>        ag.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;韶关学院&quot;</span>);<br>        System.<span class="hljs-keyword">out</span>.print(<span class="hljs-string">&quot;聚合的内容有：&quot;</span>);<br>        Iterator it = ag.getIterator();<br>        <span class="hljs-keyword">while</span>(it.hasNext())&#123;<br>            Object obj = it.next();<br>            System.<span class="hljs-keyword">out</span>.print(ob.toString()+<span class="hljs-string">&quot;\t&quot;</span>);<br>        &#125;<br>        Object ob = it.first();<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;\nFirst：&quot;</span>+ob.toString());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>应用实现：用迭代器模式编写一个浏览旅游风景图的程序。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//代码实现</span><br><span class="hljs-comment">//实体类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Spot</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String introduce;<br>    Spot(String name,String introduce)&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.introduce = introduce;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getIntroduce</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.introduce;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象聚合类:景点集接口</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">ViewSpotSet</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params">Spot obj</span>)</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">remove</span>(<span class="hljs-params">Spot obj</span>)</span>;<br>    <span class="hljs-function">ViewSpotIterator <span class="hljs-title">getIterator</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体聚合类：景点集</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewSpotSet</span> <span class="hljs-title">implements</span> <span class="hljs-title">ViewSpotSet</span>&#123;<br>    <span class="hljs-keyword">private</span> ArrayList&lt;Spot&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;Spot&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params">Spot obj</span>)</span>&#123;<br>        list.<span class="hljs-keyword">add</span>(obj);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span>(<span class="hljs-params">Spot obj</span>)</span>&#123;<br>        list.<span class="hljs-keyword">remove</span>(obj);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ViewSpotIterator <span class="hljs-title">getIterator</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> MyViewSpotIterator(list));<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象迭代器：景点迭代器接口</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">ViewSpotIterator</span>&#123;<br>    <span class="hljs-function">boolean <span class="hljs-title">hasNext</span>()</span>;<br>    <span class="hljs-function">Spot <span class="hljs-title">first</span>()</span>;<br>    <span class="hljs-function">Spot <span class="hljs-title">next</span>()</span>;<br>    <span class="hljs-function">Spot <span class="hljs-title">previous</span>()</span>;<br>    <span class="hljs-function">Spot <span class="hljs-title">last</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体迭代器：景点迭代器</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewSpotIterator</span> <span class="hljs-title">implements</span> <span class="hljs-title">ViewSpotIterator</span>&#123;<br>    <span class="hljs-keyword">private</span> ArrayList&lt;Spot&gt; list = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> index = <span class="hljs-number">-1</span>;<br>    Spot obj = <span class="hljs-literal">null</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyViewSpotIterator</span>(<span class="hljs-params">ArrayList&lt;Spot&gt; list</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.list = list;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> boolean <span class="hljs-title">hasNext</span>()</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &lt; list.size() - <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Spot <span class="hljs-title">first</span>()</span>&#123;<br>        index = <span class="hljs-number">0</span>;<br>        obj = list.<span class="hljs-keyword">get</span>(index);<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Spot <span class="hljs-title">next</span>()</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.hasNext())&#123;<br>            obj = list.<span class="hljs-keyword">get</span>(index);<br>        &#125;<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Spot <span class="hljs-title">previous</span>()</span>&#123;<br>        <span class="hljs-keyword">if</span>(index &gt; <span class="hljs-number">0</span>)&#123;<br>            obj = list.<span class="hljs-keyword">get</span>(--index);<br>        &#125;<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Spot <span class="hljs-title">last</span>()</span>&#123;<br>        index = list.size()<span class="hljs-number">-1</span>;<br>        obj = list.<span class="hljs-keyword">get</span>(index);<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>应用场景：</p>
<p>1.当需要为聚合对象提供多种遍历方式时。</p>
<p>2.当需要为遍历不同的聚合结构提供一个统一的接口时。</p>
<p>3.当访问一个聚合对象的内容而无须暴露其内部实现细节的表示时。</p>
<h2 id="4-优缺点分析-15"><a href="#4-优缺点分析-15" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>迭代器模式的定义：提供一个对象来顺序访问聚合对象中的一系列数据，而不暴露聚合对象的内部表示。迭代器模式是一种对象行为型模式，其主要优点如下：</p>
<p>1.访问一个聚合对象的内容而无须暴露它的内部表示。</p>
<p>2.遍历任务交由迭代器完成，这简化了聚合类。</p>
<p>3.它支持以不同方式遍历一个聚合，甚至可以自定义迭代器的子类以支持新的遍历。</p>
<p>4.增加新的聚合类和迭代器类都很方便，无须修改原有代码。</p>
<p>5.封装性良好，为遍历不同的聚合结构提供一个统一的接口。</p>
<p>缺点：</p>
<p>主要缺点是增加了类的个数，这在一定程度上增加了系统的复杂性。</p>
<p>在日常开发中，我们几乎不会自己写迭代器。除非需要定制一个自己实现的数据结构对应的迭代器，否则，开源框架提供的API完全够用。</p>
<h1 id="十八、中介者模式"><a href="#十八、中介者模式" class="headerlink" title="十八、中介者模式"></a>十八、中介者模式</h1><h2 id="1-解释-17"><a href="#1-解释-17" class="headerlink" title="1.解释"></a>1.解释</h2><p>在现实生活中，常常会出现好多对象之间存在复杂的交互关系，这种交互关系常常是”网状结构”，它要求每个对象都必须知道它需要交互的对象。例如，每个人必须记住他所有朋友的电话；而且，朋友中如果有的人电话修改了，他必须让其他所有的朋友一起修改，这叫作”牵一发而动全身”，非常复杂。</p>
<p>如果把这种”网状结构”改为”星型结构”的话，将大大降低它们之间的”耦合性”,这时只要找一个”中介者”就可以了。如前面所说的”每个人必须记住所有朋友电话”的问题，只要在网上建立一个朋友都可以访问的“通信录”就解决了。这样的例子还有很多，例如，你刚刚参加工作想租房，可以找“房屋中介”；或者，自己刚刚到一个陌生城市找工作，可以找“人才交流中心”帮忙。</p>
<p>使用中介者模式，它将大大降低对象之间的耦合性，提高系统的灵活性。</p>
<p>中介者模式的定义：定义一个中介对象来封装一系列对象之间的交互，使原有对象之间的耦合松散，且可以独立的改变它们之间的交互。中介者模式又叫调停模式，它是迪米特法则的典型应用。</p>
<h2 id="2-包含的角色-16"><a href="#2-包含的角色-16" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象中介者（Mediator）角色：它是中介者的接口，提供了同事对象注册与转发同事对象信息的抽象方法。</p>
<p>2.具体中介者（Concrete Mediator）角色：实现中介者接口，定义一个list来管理同事对象，协调各个同事对象之间的交互关系，因此它依赖于同事角色。</p>
<p>3.抽象同事类（Colleague）角色：定义同事类的接口，保存中介者对象，提供同事对象交互的抽象方法，实现所有相互影响的同事类的公共功能。</p>
<p>4.具体同事类（Concrete Colleague）角色：是抽象同事类的实现者，当需要与其他同事对象交互时，由中介者对象负责后续的交互。</p>
<h2 id="3-使用场景分析及代码分析"><a href="#3-使用场景分析及代码分析" class="headerlink" title="3.使用场景分析及代码分析"></a>3.使用场景分析及代码分析</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象中介者</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Mediator</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">register</span>(<span class="hljs-params">Colleague colleague</span>)</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">relay</span>(<span class="hljs-params">Colleague cl</span>)</span>;<span class="hljs-comment">//转发</span><br>&#125;<br><span class="hljs-comment">//具体中介者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteMediator</span> <span class="hljs-title">extends</span> <span class="hljs-title">Mediator</span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;Colleague&gt; colleagues = <span class="hljs-keyword">new</span> ArrayList&lt;Colleage&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">register</span>(<span class="hljs-params">Colleague colleague</span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(!colleagues.contains(colleague))&#123;<br>            colleagues.<span class="hljs-keyword">add</span>(colleague);<br>            colleague.setMedium(<span class="hljs-keyword">this</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">relay</span>(<span class="hljs-params">Colleague cl</span>)</span>&#123;<br>        <span class="hljs-keyword">for</span>(Colleague ob:colleagues)&#123;<br>            <span class="hljs-keyword">if</span>(!ob.<span class="hljs-keyword">equals</span>(cl))&#123;<br>                ((Colleague)ob).receive()<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象同事类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Colleague</span>&#123;<br>    <span class="hljs-keyword">protected</span> Mediator mediator;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMedium</span>(<span class="hljs-params">Mediator mediator</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.mediator = mediator;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span>()</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体同事类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteColleague1</span> <span class="hljs-title">extends</span> <span class="hljs-title">Colleague</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体同事1收到请求&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span>()</span>&#123;<br>     System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体同事类1发出请求&quot;</span>);<br>        mediator.relay(<span class="hljs-keyword">this</span>);<span class="hljs-comment">//请中介者转发</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体同事类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteColleague2</span> <span class="hljs-title">extends</span> <span class="hljs-title">Colleague</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">receive</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体类同事类2收到请求。&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">send</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体同事类2发出请求&quot;</span>);<br>        mediator.relay(<span class="hljs-keyword">this</span>);<span class="hljs-comment">//请中介者转发</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MediatorPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Mediator md = <span class="hljs-keyword">new</span> ConcreteMediator();<br>        Colleague c1,c2;<br>        c1 = <span class="hljs-keyword">new</span> ConcreteColleague1();<br>        c2 = <span class="hljs-keyword">new</span> ConcreteColleague2();<br>        md.register(c1);<br>        md.register(c2);<br>        c1.send();<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;-----------&quot;</span>);<br>        c2.send();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//运行结果如下：</span><br>具体同事类<span class="hljs-number">1</span>发出请求。<br>具体同事类<span class="hljs-number">2</span>收到请求。<br>-------------<br>具体同事类<span class="hljs-number">2</span>发出请求。<br>具体同事类<span class="hljs-number">1</span>收到请求。<br></code></pre></td></tr></table></figure>

<p>应用场景分析：</p>
<p>当对象之间存在复杂的网状结构关系而导致依赖关系混乱且难以复用的时。</p>
<p>当想创建一个运行于多个类之间的对象，又不想生成新的子类时。</p>
<h2 id="4-优缺点分析-16"><a href="#4-优缺点分析-16" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1.类之间各司其职，符合迪米特法则。</p>
<p>2.降低了对象之间的耦合性，使得对象易于独立的被复用。</p>
<p>3.将对象间的一对多关联转变为一对一的关联，提高系统的灵活性，使得系统易于维护和扩展。</p>
<p>缺点：</p>
<p>中介者模式将原本多个对象直接的相互依赖变成了中介者和多个同事类的依赖关系。当同事类越多时，中介者就会越臃肿，变的复杂且难以维护。</p>
<h1 id="十九、备忘录模式"><a href="#十九、备忘录模式" class="headerlink" title="十九、备忘录模式"></a>十九、备忘录模式</h1><h2 id="1-解释-18"><a href="#1-解释-18" class="headerlink" title="1.解释"></a>1.解释</h2><p>每个人都有犯错误的时候，都希望有种“后悔药”能弥补自己的过失，让自己重新开始，但现实很残酷。在计算机应用中，客户同样会常常犯错误，能否提供“后悔药”给他们呢？当然可以！而且是有必要的。这个功能是“备忘录模式”。</p>
<p>备忘录模式能记录一个对象的内部状态，当用户后悔时能撤销当前的操作，使数据恢复到它原先的状态。</p>
<p>备忘录模式的定义：在不破环封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，以便以后当需要将该对象恢复到原先保存的状态，该模式又叫快照模式。</p>
<h2 id="2-包含的角色-17"><a href="#2-包含的角色-17" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.发起人（Originator）角色：记录当前时刻的内部状态信息，提供创建备忘录和恢复备忘录数据的功能，实现其它业务功能，它可以访问备忘录里的所有信息。</p>
<p>2.备忘录（Memento）角色：负责存储发起人的内部状态，在需要的时候提供这些内部状态给发起人。</p>
<p>3.管理人（Caretaker）角色：对备忘录进行管理，提供保存与获取备忘录的功能，但其不能对备忘录的内容进行访问和修改。</p>
<h2 id="3-使用场景分析及代码实现-14"><a href="#3-使用场景分析及代码实现-14" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//备忘录</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Memento</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> state;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Memento</span>(<span class="hljs-title class_">String</span> state)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setState</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> state</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getState</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//发起人</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Originator</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> state;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setState</span>(<span class="hljs-params"><span class="hljs-title class_">String</span> state</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getState</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Memento</span> <span class="hljs-title function_">createMemento</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Memento</span>(state);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">restoreMemento</span>(<span class="hljs-params"><span class="hljs-title class_">Memento</span> m</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(m.<span class="hljs-title function_">getState</span>());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//管理者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Caretaker</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Memento</span> memento;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setMemento</span>(<span class="hljs-params"><span class="hljs-title class_">Memento</span> m</span>)&#123;<br>        memento = m;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Memento</span> <span class="hljs-title function_">getMemento</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> memento;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MementoPattern</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-title class_">String</span>[] args</span>)&#123;<br>        <span class="hljs-title class_">Originator</span> or = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Originator</span>();<br>        <span class="hljs-title class_">Caretaker</span> cr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Caretaker</span>();<br>        or.<span class="hljs-title function_">setState</span>(<span class="hljs-string">&quot;S0&quot;</span>);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;初始状态：&quot;</span>+or.<span class="hljs-title function_">getState</span>());<br>        cr.<span class="hljs-title function_">setMemento</span>(or.<span class="hljs-title function_">createMemento</span>());<span class="hljs-comment">//保存状态</span><br>        or.<span class="hljs-title function_">setState</span>(<span class="hljs-string">&quot;S1&quot;</span>);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;新的状态：&quot;</span>+or.<span class="hljs-title function_">getState</span>());<br>        or.<span class="hljs-title function_">restoreMemento</span>(cr.<span class="hljs-title function_">getMemento</span>());<span class="hljs-comment">//恢复状态</span><br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;恢复状态:&quot;</span>+or.<span class="hljs-title function_">getState</span>())；<br>    &#125;<br>&#125;<br><span class="hljs-comment">//结果打印</span><br>初始状态:<span class="hljs-variable constant_">S0</span><br>新的状态:<span class="hljs-variable constant_">S1</span><br>恢复状态:<span class="hljs-variable constant_">S0</span><br></code></pre></td></tr></table></figure>

<p>应用场景：<br>1.需要保存与恢复数据的场景，如玩游戏时的中间结果的存档功能。</p>
<p>2.需要提供一个可回滚操作的场景，如word、记事本、photoshop，Eclipse等软件在编辑时按ctrl+z组合键，还有数据库中事务操作。</p>
<h2 id="4-优缺点分析-17"><a href="#4-优缺点分析-17" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>提供了一种可以恢复状态的机制。当用户需要时能够比较方便的将数据恢复到某个历史的状态。</p>
<p>实现了内部状态的封装。除了创建它的发起人之外，其他对象都不能访问这些状态信息。</p>
<p>简化了发起人类。发起人不需要管理和保护其内部状态的各个备份，所有状态信息都保存在备忘录中，并由管理者进行管理，符合单一职责原则。</p>
<p>缺点：</p>
<p>资源消耗大。如果要保存的内部状态信息过多或者特别频繁，将会占用比较大的内存资源。</p>
<h1 id="二十、访问者模式"><a href="#二十、访问者模式" class="headerlink" title="二十、访问者模式"></a>二十、访问者模式</h1><h2 id="1-解释-19"><a href="#1-解释-19" class="headerlink" title="1.解释"></a>1.解释</h2><p>在现实生活中，有些集合对象中存在多种不同的元素，且每种元素也存在多种不同的访问者和处理方式。例如，公园中存在多个景点，也存在多个游客，不同的游客对同一个景色的评价可能不同；医院医生开的处方单中包含多种药元素，查看它的划价员和药房工作人员对它的处理方式也不同，划价员根据处方单上面的药品名和数量进行划价，药房工作人员根据处方单的内容进行抓药。</p>
<p>这些被处理的数据元素相对稳定而访问方式多种多样的数据结构，如果用“访问者模式”来处理比较方便。访问者模式能把处理方法从数据结构中分离出来，并可以根据需要增加新的处理方法，且不用修改原来的程序结构与数据结构，这提高了程序的扩展性和灵活性。</p>
<p>访问者模式的定义：将作用于某种数据结构中的各元素的操作分离出来封装成独立的类，使其在不改变数据结构的前提下可以添加作用于这些元素的新的操作，为数据结构中的每个元素提供多种访问方式。他将对数据的操作与数据结构进行分离，是行为类模式中最复杂的一种模式。</p>
<h2 id="2-包含的角色-18"><a href="#2-包含的角色-18" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象访问者（Visitor）角色：定义一个访问具体元素的接口，为每个具体类对应一个访问操作visit()，该操作中的参数类型标识了被访问的具体元素。</p>
<p>2.具体访问者（ConcreteVisitor）角色：实现抽象访问者角色中声明的各个访问操作，确定访问者访问一个元素时该做什么。</p>
<p>3.抽象元素（Element）角色：声明一个包含接受操作accept()的接口，被接受的访问者对象作为accept()方法的参数。</p>
<p>4.具体元素（ConcreteElement）角色：实现抽象元素本身角色提供的accept()操作，其方法体通常都是visitor.visit（this）,另外具体元素中可能还包含本身业务逻辑的相关操作。</p>
<p>5.对象结构（ObjectStructure）角色：是一个包含元素角色的容器，提供让访问者对象遍历容器中的所有元素的方法，通常由List、Set、Map等聚合类实现。</p>
<h2 id="3-使用场景分析及代码实现-15"><a href="#3-使用场景分析及代码实现-15" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//抽象访问者</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Visitor</span>&#123;<br>    <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-title class_">ConcreteElementA</span> element);<br>    <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-title class_">ConcreteElementB</span> element);<br>&#125;<br><span class="hljs-comment">//具体访问者A类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteVisitorA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Visitor</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-params"><span class="hljs-title class_">ConcreteElementA</span> element</span>)&#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;具体访问者A访问--&gt;&quot;</span> + element.<span class="hljs-title function_">operationA</span>());<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-params"><span class="hljs-title class_">ConcreteElmentB</span> element</span>)&#123;<br>       <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;具体访问者A访问--&gt;&quot;</span> + element.<span class="hljs-title function_">operationB</span>());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体访问者B类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteVisitorB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Visitor</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-params"><span class="hljs-title class_">ConcreteElementA</span> element</span>)&#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;具体访问者B访问--&gt;&quot;</span> + element.<span class="hljs-title function_">operationA</span>());<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">visit</span>(<span class="hljs-params"><span class="hljs-title class_">ConcreteElmentB</span> element</span>)&#123;<br>       <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;具体访问者B访问--&gt;&quot;</span> + element.<span class="hljs-title function_">operationB</span>());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象元素类</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Element</span>&#123;<br>    <span class="hljs-built_in">void</span> <span class="hljs-title function_">accept</span>(<span class="hljs-title class_">Visitor</span> visitor);<br>&#125;<br><span class="hljs-comment">//具体元素A类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteElementA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Element</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">accept</span>(<span class="hljs-params"><span class="hljs-title class_">Visitor</span> visitor</span>)&#123;<br>        visitor.<span class="hljs-title function_">visit</span>(<span class="hljs-variable language_">this</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operationA</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;具体元素A的操作&quot;</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体元素B类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteElementB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Element</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">accept</span>(<span class="hljs-params"><span class="hljs-title class_">Visitor</span> visitor</span>) &#123;<br>        visitor.<span class="hljs-title function_">visit</span>(<span class="hljs-variable language_">this</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">operationB</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;具体元素B的操作。&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//对象结构角色</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectStructure</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Element</span>&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;<span class="hljs-title class_">Element</span>&gt;();<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">accept</span>(<span class="hljs-params"><span class="hljs-title class_">Visitor</span> visitor</span>) &#123;<br>        <span class="hljs-title class_">Iterator</span>&lt;<span class="hljs-title class_">Element</span>&gt; i = list.<span class="hljs-title function_">iterator</span>();<br>        <span class="hljs-keyword">while</span> (i.<span class="hljs-title function_">hasNext</span>()) &#123;<br>            ((<span class="hljs-title class_">Element</span>) i.<span class="hljs-title function_">next</span>()).<span class="hljs-title function_">accept</span>(visitor);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"><span class="hljs-title class_">Element</span> element</span>) &#123;<br>        list.<span class="hljs-title function_">add</span>(element);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">remove</span>(<span class="hljs-params"><span class="hljs-title class_">Element</span> element</span>) &#123;<br>        list.<span class="hljs-title function_">remove</span>(element);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VisitorPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-title class_">String</span>[] args</span>) &#123;<br>        <span class="hljs-title class_">ObjectStructure</span> os = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectStructure</span>();<br>        os.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteElementA</span>());<br>        os.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteElementB</span>());<br>        <span class="hljs-title class_">Visitor</span> visitor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteVisitorA</span>();<br>        os.<span class="hljs-title function_">accept</span>(visitor);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;------------------------&quot;</span>);<br>        visitor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteVisitorB</span>();<br>        os.<span class="hljs-title function_">accept</span>(visitor);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-18"><a href="#4-优缺点分析-18" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1）扩展性好，能够在不修改对象结构中的元素的情况下，为对象结构中的元素添加新的功能。</p>
<p>2）复用性好。可以通过访问者来定义整个对象结构通用的功能，从而提高系统的复用程度。</p>
<p>3）灵活性好。访问者模式将数据结构与作用与结构上的对象解耦，使得操作集合可相对自由地演化而不影响系统的数据结构。</p>
<p>4）符合单一职责原则。访问者模式把相关的行为封装在一起，构成一个访问者，使得每个访问者的功能都比较单一。</p>
<p>缺点：</p>
<p>1）添加新的元素类很困难。在访问者模式中，每增加一个新的元素类，都要在每一个具体访问类中增加相应的具体操作，这违背了“开闭原则”。</p>
<p>2）破坏封装。访问者模式中具体元素对访问者公布细节，这破坏了对象的封装性。</p>
<p>3）违反了依赖倒置原则。访问者模式依赖了具体类，而没有依赖抽象类。</p>
<h1 id="二十一、模板方法模式"><a href="#二十一、模板方法模式" class="headerlink" title="二十一、模板方法模式"></a>二十一、模板方法模式</h1><h2 id="1-解释-20"><a href="#1-解释-20" class="headerlink" title="1.解释"></a>1.解释</h2><p>在面向对象程序设计过程中，程序员常常会遇到这样的情况：设计一个系统时知道了算法所需的关键步骤，而且确定了这些步骤的执行顺序，但某些步骤的具体实现还未知，或者说某些步骤的实现与具体的环境相关。</p>
<p>例如：一个人每天会起床、吃饭、做事、睡觉等，其中“做事”的内容每天可能不同。我们把这些规定了流程或格式的实例定义成模板，允许使用者根据需求去更新它，例如，简历模板、论问模板、Word中的模板文件等。</p>
<p>模板方法模式定义：定义一个操作中的算法骨架，而将算法的一些步骤延迟到子类中，使得子类可以不改变该算法结构的情况下重定义该算法的某些特定步骤。它是一种类行为型模式。</p>
<h2 id="2-包含的角色-19"><a href="#2-包含的角色-19" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>1.抽象类&#x2F;抽象模板（Abstract Class）</p>
<p>抽象模板类，负责给出一个算法的轮廓和骨架。它由一个模板方法和若干个基本方法构成。这些方法的定义如下。</p>
<p>1）模板方法：定义了算法的骨架，按某种顺序调用其包含的基本方法。</p>
<p>2）基本方法：是整个算法中的一个步骤，包含以下几种类型。</p>
<p>抽象方法：在抽象类中声明，由具体子类实现。</p>
<p>具体方法：在抽象类中已经实现，在具体子类中可以继承或重写它。</p>
<p>钩子方法：在抽象类中已经实现，包括用于判断的逻辑方法和需要子类重写的空方法两种。</p>
<p>2.具体子类&#x2F;具体实现（Concrete Class）</p>
<p>具体实现类，实现抽象类中所定义的抽象方法和钩子方法，他们是一个顶级逻辑的一个组成步骤。</p>
<h2 id="3-使用场景分析及代码实现-16"><a href="#3-使用场景分析及代码实现-16" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AbstractClass</span>&#123;<br>    <span class="hljs-comment">//模板方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TemplateMethod</span>()</span>&#123;<br>        SpecificMethod();<br>        abstractMethod1();<br>        abstractMethod2();<br>    &#125;<br>    <span class="hljs-comment">//具体方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpecificMethod</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象类中的具体方法调用...&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//抽象方法1</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod1</span>()</span>;<br>    <span class="hljs-comment">//抽象方法2</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod2</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体子类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteClass</span> <span class="hljs-title">extends</span> <span class="hljs-title">AbstractClass</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod1</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象方法1的实现被调用...&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod2</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象方法2的实现被调用...&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TemplateMethodPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        AbstractClass tm = <span class="hljs-keyword">new</span> ConcreteClass();<br>        tm.TemplateMethod();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//运行结果如图</span><br>抽象类中的具体方法被调用...<br>抽象方法<span class="hljs-number">1</span>的实现被调用...<br>抽象方法<span class="hljs-number">2</span>的实现被调用...<br></code></pre></td></tr></table></figure>

<p>应用场景：</p>
<p>1）算法的整体步骤很固定，但其中个别部分易变的时候，这时候可以使用模板方法模式，将容易变得部分抽象出来，供子类实现。</p>
<p>2）当多个子类存在公共的行为时，可以将其提取出来并集中到一个公共父类中以避免代码重复。首先，要识别现有代码中的不同之处，并且将不同之处分离为新的操作。最后，用一个调用这些新的操作的模板方法来替换这些不同的代码。</p>
<p>3）当需要控制子类的扩展时，模板方法只在特定点调用钩子操作，这样就只允许在这些点进行扩展。</p>
<p>扩展：</p>
<p>在模板方法模式中，基本方法包含：抽象方法、具体方法和钩子方法，正确使用“钩子方法”可以使得子类控制父类的行为。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//含钩子方法</span><br><span class="hljs-comment">//抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HookAbstractClass</span>&#123;<br>    <span class="hljs-comment">//模板方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TemplateMethod</span>()</span>&#123;<br>        abstractMethod1();<br>        hookMethod1();<br>        <span class="hljs-keyword">if</span>(hookMethod2())&#123;<br>            specificMethod();<br>        &#125;<br>        abstractMethod2();<br>    &#125;<br>    <span class="hljs-comment">//具体方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">specificMethod</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象类中的具体方法被调用...&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//钩子方法1</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">hookMethod1</span>()</span>&#123;<br>    &#125;<br>    <span class="hljs-comment">//钩子方法2</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">hookMethod2</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-comment">//抽象方法1</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod1</span>()</span>;<br>    <span class="hljs-comment">//抽象方法2</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod2</span>()</span>;<br>&#125;<br><span class="hljs-comment">//具体子类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">HookConcreteClass</span> <span class="hljs-title">extends</span> <span class="hljs-title">HookAbstractClass</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod1</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象方法1的实现被调用...&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">abstractMethod2</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;抽象方法2的实现被调用...&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">hookMethod1</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;钩子方法1被重写...&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> boolean <span class="hljs-title">hookMethod2</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HookTemplateMethod</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        HookAbstractClass tm = <span class="hljs-keyword">new</span> HookAbstractClass();<br>        tm.TemplateMethod();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//运行结果</span><br>抽象方法<span class="hljs-number">1</span>的实现被调用...<br>钩子方法<span class="hljs-number">1</span>被重写...<br>抽象方法<span class="hljs-number">2</span>的实现被调用...<br></code></pre></td></tr></table></figure>

<h2 id="4-优缺点分析-19"><a href="#4-优缺点分析-19" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1）封装了不变的部分，扩展了可变的部分。它把认为是不变部分的算法封装到父类中实现，而把可变部分算法由子类继承实现，便于子类继续扩展。</p>
<p>2）它在父类中提取了公共的部分代码，便于代码复用。</p>
<p>3）部分方法是由子类实现的，因此子类可以通过扩展方法增加相应的功能，符合开闭原则。</p>
<p>缺点：<br>1）对每个不同的实现都需要定义一个子类，这会导致类的个数增大，系统更加庞大，设计也更加抽象，间接地增加了系统实现的复杂度。</p>
<p>2）父类中的抽象方法由子类实现，子类执行的结果会影响父类的结果，这导致一种反向的控制结构，它提高了代码阅读的难度。</p>
<p>3）由于继承关系自身的缺点，如果父类添加新的抽象方法，则所有的子类都要改一遍。</p>
<h1 id="二十二、策略模式"><a href="#二十二、策略模式" class="headerlink" title="二十二、策略模式"></a>二十二、策略模式</h1><h2 id="1-解释-21"><a href="#1-解释-21" class="headerlink" title="1.解释"></a>1.解释</h2><p>在现实生活中常常遇到实现某种目标存在多种策略可供选择的情况，例如，出行旅游可以乘坐飞机、乘坐火车、骑自行车或自己开私家车等，超市促销可以采用打折、送商品、送积分等方法。</p>
<p>在软件开发中也常常遇到类似的情况，当实现某一个功能存在多种算法或者策略，我们可以根据环境或者条件的不同选择不同的算法或者策略来完成该功能，如数据排序策略有冒泡排序、选择排序、插入排序、二叉树排序等。</p>
<p>如果使用多重条件转移语句实现（即硬编码），不但使条件语句变得很复杂，而且增加、删除或更换算法要修改源代码，不易维护，违背开闭原则。如果采用策略模式就能很好的解决该问题。</p>
<p>策略模式定义：该模式定义了一系列算法，并将每个算法封装起来，使他们可以相互替换，且算法的变化不会影响使用算法的客户。策略模式属于对象行为模式，它通过对算法进行封装，把使用算法的责任和算法的实现分割开来，并委派给不同的对象对这些算法进行管理。</p>
<h2 id="2-包含的角色-20"><a href="#2-包含的角色-20" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）抽象策略（Strategy）类：定义了一个公共接口，各种不同的算法以不同的方式实现这个接口，环境角色使用这个接口调用不同的算法，一般使用接口或抽象类实现。</p>
<p>（2）具体策略（Concrete Strategy）类：实现了抽象策略定义的接口，提供具体的算法实现。</p>
<p>（3）环境（Context）类：持有一个策略类的引用，最终给客户端调用。</p>
<h2 id="3-使用场景分析及代码实现-17"><a href="#3-使用场景分析及代码实现-17" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//抽象策略类</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title">Strategy</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">strategyMethod</span>()</span>;<span class="hljs-comment">//策略方法</span><br>&#125;<br><span class="hljs-comment">//具体策略类A</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteStrategyA</span> <span class="hljs-title">implements</span> <span class="hljs-title">Strategy</span>&#123;<br> 	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">strategyMethod</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体策略A的策略方法被访问！&quot;</span>);<br>    &#125;    <br>&#125;<br><span class="hljs-comment">//具体策略类B</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteStrategyB</span> <span class="hljs-title">implements</span> <span class="hljs-title">Strategy</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">strategyMethod</span>()</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;具体策略B的策略方法被访问！&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//环境类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Context</span>&#123;<br>    <span class="hljs-keyword">private</span> Strategy strategy;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Strategy <span class="hljs-title">getStrategy</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> strategy;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStrategy</span>(<span class="hljs-params">Strategy strategy</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.strategy = strategy;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">strategyMethod</span>()</span>&#123;<br>        strategy.strategyMethod();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">StrategyPattern</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Context c = <span class="hljs-keyword">new</span> Context();<br>        Strategy s = <span class="hljs-keyword">new</span> ConcreteStrategyA();<br>        c.setStrategy(s);<br>        c.strategyMethod();<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;----------&quot;</span>);<br>        s = <span class="hljs-keyword">new</span> ConcreteStrategyB();<br>        c.setStrategy(s);<br>        c.strategyMethod();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//运行结果</span><br>具体策略A的策略方法被访问！<br>-----------------<br>具体策略B的策略方法被访问！<br></code></pre></td></tr></table></figure>

<p>应用场景分析：</p>
<p>1.一个系统需要动态地在几种算法中选择一种时，可将每个算法封装到策略类中。</p>
<p>2.一个类中定义了多种行为，并且这些行为在这个类的操作中以多个条件语句的形式出现，可将每个条件分支移入它们各自的策略类中以代替这些条件语句。</p>
<p>3.系统中各算法彼此完全独立，且要求对客户隐藏具体算法的实现细节时。</p>
<p>4.系统要求使用算法的客户不应该知道其操作的数据时，可使用策略模式来隐藏与算法相关的数据结构。</p>
<p>5.多个类只区别在表现行为不同，可以使用策略模式，在运行时动态选择具体要执行的行为。</p>
<p>扩展：</p>
<p>在一个使用策略模式的系统中，当存在的策略很多时，客户端管理所有策略算法将变的很复杂，如果在环境类中使用策略工厂模式来管理这些策略类将大大的减少客户端的工作复杂度。</p>
<h2 id="4-优缺点分析-20"><a href="#4-优缺点分析-20" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1.多重条件语句不易维护，而使用策略模式可以避免使用多重条件语句，如if…else语句、switch…case语句。</p>
<p>2.策略模式提供了一系列的可供重用的算法族，恰当使用继承可以把算法族的公共代码转移到父类里面，从而避免重复的代码。</p>
<p>3.策略模式可以提供相同行为的不同实现，客户可以根据不同时间或空间要求选择不同的。</p>
<p>4.策略模式提供了对开闭原则的完美支持，可以在不修改源代码的情况下，灵活的增加算法。</p>
<p>5.策略模式把算法的使用放到环境类中，而算法的实现移到具体策略类中，实现了二者的分离。</p>
<p>缺点：</p>
<p>1.客户端必须理解所有策略算法的区别，以便适时选择恰当的算法类。</p>
<p>2.策略模式造成很多的策略类，增加维护难度。</p>
<h1 id="二十三、状态模式"><a href="#二十三、状态模式" class="headerlink" title="二十三、状态模式"></a>二十三、状态模式</h1><h2 id="1-解释-22"><a href="#1-解释-22" class="headerlink" title="1.解释"></a>1.解释</h2><p>在软件开发过程中，应用程序中的部分对象可能会根据不同情况做出不同的行为，我们把这种对象称为有状态的对象，而把影响对象行为的一个或多个动态变化的属性称为状态。当有状态的对象与外部事件产生互动时，其内部状态就会发生变化。如人都有高兴和伤心的时候，不同的情绪有不同的行为，当然外界也会影响其情绪变化。</p>
<p>对这种有状态的对象编程，传统的解决方案是：将这些所有可能发生的情况全都考虑到，然后使用if-else或switch-case语句来做状态判断，再进行不同的情况处理。但是显然这种做法对复杂的状态判断存在天然弊端，条件判断语句会过于臃肿，可读性差，且不具备扩展性，维护难度也大。且增加新的状态时要添加新的if-else语句，这违背了”开闭原则“，不利于程序的扩展。</p>
<p>以上问题如果采用”状态模式“就能很好的得到解决。状态模式的解决思想是：当控制一个对象状态转换的条件表达式过于复杂时，把相关”判断逻辑“提取出来，用各个不同的类进行表示，系统处于哪种情况，直接使用相应的状态类对象进行处理，这样能把原来复杂的逻辑判断简单化，消除了if-else、switch-case等冗余语句，代码更有层次性，并且具备良好的扩展力。</p>
<p>状态模式的定义：对有状态的对象，把复杂的”判断逻辑“提取到不同的状态对象中，允许状态对象在其内部状态发生改变时改变其行为。</p>
<h2 id="2-包含的角色-21"><a href="#2-包含的角色-21" class="headerlink" title="2.包含的角色"></a>2.包含的角色</h2><p>（1）环境类（Context）角色：也称上下文，它定义了客户端需要的接口，内部维护一个当前状态，并负责具体状态的切换。</p>
<p>（2）抽象状态（State）角色：定义一个接口，用以封装环境对象中的特定状态所对应的行为，可以有一个或多个行为。</p>
<p>（3）具体状态（Concrete State）角色：实现抽象状态所对应的行为，并且在需要的情况下进行状态切换。</p>
<h2 id="3-使用场景分析及代码实现-18"><a href="#3-使用场景分析及代码实现-18" class="headerlink" title="3.使用场景分析及代码实现"></a>3.使用场景分析及代码实现</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//环境类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">Context</span>&#123;<br>    <span class="hljs-keyword">private</span> State state;<br>    <span class="hljs-comment">//定义环境类的初始状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Context</span>()</span>&#123;<br>        <span class="hljs-keyword">this</span>.state = <span class="hljs-keyword">new</span> ConcreteStateA();<br>    &#125;<br>    <span class="hljs-comment">//设置新状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setState</span>(<span class="hljs-params">State state</span>)</span>&#123;<br>        <span class="hljs-keyword">this</span>.state = state;<br>    &#125;<br>    <span class="hljs-comment">//读取状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> State <span class="hljs-title">getState</span>()</span>&#123;<br>        <span class="hljs-keyword">return</span> (state);<br>    &#125;<br>    <span class="hljs-comment">//对请求做处理</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Handle</span>()</span>&#123;<br>        state.Handle(<span class="hljs-keyword">this</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//抽象状态类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">State</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Handle</span>(<span class="hljs-params">Context context</span>)</span>;<br>&#125;<br><span class="hljs-comment">//具体状态A类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteStateA</span> <span class="hljs-title">extends</span> <span class="hljs-title">State</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Handle</span>(<span class="hljs-params">Context context</span>)</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;当前状态是A&quot;</span>);<br>        context.setState(<span class="hljs-keyword">new</span> ConcreteStateB());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//具体状态B类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteStateB</span> <span class="hljs-title">extends</span> <span class="hljs-title">State</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Handle</span>(<span class="hljs-params">Context context</span>)</span>&#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;当前状态是B&quot;</span>);<br>        context.setState(<span class="hljs-keyword">new</span> ConcreteStateA());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//客户端</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">StatePatternClient</span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] <span class="hljs-keyword">args</span></span>)</span>&#123;<br>        Context context = <span class="hljs-keyword">new</span> Context();<span class="hljs-comment">//创建环境</span><br>        context.Handle();<span class="hljs-comment">//处理请求</span><br>        context.Handle();<br>        context.Handle();<br>        context.Handle(); <br>    &#125;<br>&#125;<br><span class="hljs-comment">//运行结果</span><br>当前状态是 A.<br>当前状态是 B.<br>当前状态是 A.<br>当前状态是 B.<br></code></pre></td></tr></table></figure>

<p>应用场景：</p>
<p>1.当一个对象的行为取决于它的状态，并且它必须在运行时根据状态改变它的行为时，就可以考虑使用状态模式。</p>
<p>2.一个操作中含有庞大的分支结构，并且这些分支决定于对象的状态时。</p>
<p>扩展：</p>
<p>在有些情况下，可能有多个环境对象需要共享一组状态，这时需要引入享元模式，将这些具体状态对象放在集合中供程序共享。</p>
<h2 id="4-优缺点分析-21"><a href="#4-优缺点分析-21" class="headerlink" title="4.优缺点分析"></a>4.优缺点分析</h2><p>优点：</p>
<p>1.结构清晰，状态模式将与特定状态相关的行为局部化到一个状态中，并且将不同状态的行为分割开来，满足”单一职责原则“。</p>
<p>2.将状态转换显示化，减少对象间的相互依赖。将不同的状态引入独立的对象中会使得状态转换变得更加明确，且减少对象间的相互依赖。</p>
<p>3.状态类职责明确，有利于程序的扩展。通过定义新的子类很容易的增加新的状态和转换。</p>
<p>缺点：</p>
<p>1.状态模式的使用必然会增加系统的类与对象的个数。</p>
<p>2.状态模式的结构与实现都较为复杂，如果使用不当会导致程序结构和代码的混乱。</p>
<p>3.状态模式对开闭原则的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源码，否则无法切换到新增状态，而且修改某个状态类的行为也需要修改对应类的源码。</p>
<h2 id="5-拓展"><a href="#5-拓展" class="headerlink" title="5.拓展"></a>5.拓展</h2><p>1.状态模式与责任链模式的区别</p>
<p>状态模式和责任链模式都能消除if-else分支过多的问题。但在某些情况下，状态模式中的状态可以理解为责任，那么在这种情况下，两种模式都可以使用。</p>
<p>从定义来看，状态模式强调的是一个对象内在状态的改变，而责任链强调的是外部节点对象间的改变。</p>
<p>从代码实现上来看，两者最大的区别就是状态模式的各个状态对象知道自己要进入的下一个状态对象，而责任链不知道其下一个节点处理对象，因为链式组装由客户端负责。</p>
<p>2.状态模式和策略模式的区别</p>
<p>状态模式和策略模式的UML类图架构几乎完全一样，但两者的应用场景是不一样的。策略模式的多种算法行为择其一都能满足，彼此之间是独立的，用户可自行更换策略算法，而状态模式的各个状态间存在相互关系，彼此之间在一定条件下存在自动切换状态的效果，并且用户无法指定状态，只能设置初始状态。</p>
<h1 id="二十四、面向对象设计原则"><a href="#二十四、面向对象设计原则" class="headerlink" title="二十四、面向对象设计原则"></a>二十四、面向对象设计原则</h1><h2 id="1-开闭原则"><a href="#1-开闭原则" class="headerlink" title="1.开闭原则"></a>1.开闭原则</h2><p>软件实体应当对扩展开放，对修改关闭，这就是开闭原则的经典定义。这里的软件实体包括以下几个部分：1.项目中划分的模块 2.类与接口 3.方法</p>
<p>开闭原则的含义是：当应用的需求改变时，在不修改软件实体的源代码或者二进制代码的前提下，可以扩展模块的功能，使其满足新的需求。</p>
<p>开闭原则是面向对象程序设计的终极目标，它使软件实体拥有一定的适应性和灵活性的同时具备稳定性和延续性。作用如下：</p>
<p>1.对软件测试的影响</p>
<p>2.可以提高代码的可复用性</p>
<p>3.可以提高软件的可维护性</p>
<h2 id="2-里氏替换原则"><a href="#2-里氏替换原则" class="headerlink" title="2.里氏替换原则"></a>2.里氏替换原则</h2><p>继承必须确保超类所拥有的性质在子类中仍然成立。里氏替换原则是继承复用的基础，它反映了基类和子类之间的关系，是对开闭原则的补充，是对实现抽象化的具体步骤的规范。</p>
<p>作用：</p>
<p>1.里氏替换原则是实现开闭原则的重要方式之一。</p>
<p>2.它克服了继承中重写父类造成的可复用性变差的缺点。</p>
<p>3.它是动作正确性的保证。即类的扩展不会给已有的系统引入新的错误，降低了代码出错的可能性。</p>
<p>4.加强程序的健壮性，同时变更时可以做到非常好的兼容性，提高程序的维护性、可扩展性，降低需求变更时引入的风险。</p>
<p>里氏替换原则通俗来讲就是：子类可以扩展父类的功能，但不能改变父类原有的功能。也就是说：子类继承父类时，除添加新的方法完成新增功能外，尽量不要重写父类的方法。</p>
<p>里氏替换原则的定义：</p>
<p>1.子类可以实现父类的抽象方法，但不能覆盖父类的非抽象方法。</p>
<p>2.子类中可以增加自己特有的方法。</p>
<p>3.当子类的方法重载父类的方法时，方法的前置条件（即方法的输入参数）要比父类的方法更宽松。</p>
<p>4.当子类的方法实现父类的方法时（重写&#x2F;重载或实现抽象方法），方法的后置条件（即方法的输出&#x2F;返回值）要比父类的方法更严格或相等。</p>
<h2 id="3-依赖倒置原则"><a href="#3-依赖倒置原则" class="headerlink" title="3.依赖倒置原则"></a>3.依赖倒置原则</h2><p>原始定义为：高层模块不应该依赖底层模块，两者都应该依赖其抽象；抽象不应该依赖细节，细节应该依赖抽象。其核心思想是:要面向接口编程，不要面向实现编程。</p>
<p>依赖倒置原则是实现开闭原则的重要途经之一，它降低了客户和实现模块之间的耦合。</p>
<p>这里的抽象指的是接口或者抽象类，而细节是指具体的实现类。</p>
<p>使用接口或者抽象类的目的是制定好规范和契约，而不去涉及任何具体的操作，把展现细节的任务交给它们的实现类去完成。</p>
<p>依赖倒置原则的作用：</p>
<p>1.依赖倒置原则可以降低类间的耦合性</p>
<p>2.依赖倒置原则可以提高系统的稳定性</p>
<p>3.依赖倒置原则可以减少并行开发引起的风险</p>
<p>4.依赖倒置原则可以提高代码的可读性和可维护性</p>
<p>实现方法：<br>1.每个类尽量提供接口或抽象类，或者两者都具备。</p>
<p>2.变量的声明类型尽量是接口或者抽象类</p>
<p>3.任何类都不应该从具体类派生</p>
<p>4.使用继承时尽量遵循里氏替换原则。</p>
<h2 id="4-单一职责原则"><a href="#4-单一职责原则" class="headerlink" title="4.单一职责原则"></a>4.单一职责原则</h2><p>又称单一功能原则，这里的职责是指类变化的原因，单一职责原则规定一个类应该有且仅有一个引起它变化的原因，否则类应该被拆分。</p>
<p>该原则提出对象不应该承担太多职责，如果一个对象承担了太多的职责，至少存在以下两个缺点：</p>
<p>1.一个职责的变化可能会削弱或者抑制这个类实现其他职责的能力</p>
<p>2.当客户端需要该对象的某一个职责时，不得不将其他不需要的职责全都包含进来，从而造成冗余代码或代码的浪费。</p>
<p>优点：</p>
<p>单一职责原则的核心就是控制类的粒度大小，将对象解耦、提高内聚性。如果遵循单一职责原则将有以下优点。</p>
<p>降低类的复杂度。一个类只负责一项职责，其逻辑肯定比要负责多项职责简单的多。</p>
<p>提高类的可读性，复杂性降低，自然其可读性会提高</p>
<p>提高系统的可维护性，可读性提高了，那自然就更容易维护了。</p>
<p>变更引起的风险降低。变更是必然的，如果单一职责原则遵守的好，当修改一个功能时，可以显著降低对其他功能的影响。</p>
<h2 id="5-接口隔离原则"><a href="#5-接口隔离原则" class="headerlink" title="5.接口隔离原则"></a>5.接口隔离原则</h2><p>接口隔离原则要求程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法。</p>
<p>定义是：客户端不应该被迫依赖于它不使用的方法。该原则还有另外一个定义：一个类对另一个类的依赖应该建立在最小的接口上。</p>
<p>以上两个定义的含义是：要为各个类建立它们需要的专用接口，而不要试图去建立一个很庞大的接口供所有依赖它的类去调用。</p>
<p>接口隔离原则和单一职责原则都是为了提高类的内聚性、降低它们之间的耦合性，体现了封装的思想，但两者是不同的：<br>单一职责原则注重的是职责，而接口隔离原则注重的是对接口依赖的隔离</p>
<p>单一职责原则主要是约束类，它针对的是程序中的实现和细节；接口隔离原则主要约束接口，主要针对抽象和程序整体框架的构建。</p>
<h2 id="6-迪米特法则"><a href="#6-迪米特法则" class="headerlink" title="6.迪米特法则"></a>6.迪米特法则</h2><p>迪米特法则的定义是只与你的直接朋友交谈，不跟陌生人说话。其含义是如果两个软件实体无须直接通信，那么就不应当发生直接的相互调用，可以通过第三方转发该调用。其目的是降低类间的耦合度，提高模块的相对独立性。</p>
<p>迪米特法则中的“朋友”是指：当前对象本身、当前对象的成员对象、当前对象所创建的对象、当前对象的方法参数等，这些对象同当前对象存在关联、聚合或组合关系，可以直接访问这些对象的方法。</p>
<p>优点：</p>
<p>迪米特法则则要求限制软件实体之间的通信的宽度和深度，正确使用迪米特法则将有以下两个优点：</p>
<p>降低了类之间的耦合度，提高了模块的相对独立性。</p>
<p>由于亲和度降低，从而提高了类的可复用率和系统的扩展性。</p>
<p>但是，过度使用迪米特法则会使系统产生大量的中介类，从而增加系统的复杂性，使模块之间的通信效率降低。所以，在采用迪米特法则时需要反复权衡，确保高内聚和低耦合的同时，保证系统的结构清晰。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>设计模式</div>
      <div>https://github.com/yaosx425/yaosx425.github.io/2021/10/18/设计模式/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>姚淑璇</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年10月18日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/yaosx425/yaosx425.github.io/2021/10/23/log4j%E9%85%8D%E7%BD%AE%E8%AF%A6%E6%83%85/" title="log4j配置详情">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">log4j配置详情</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/yaosx425/yaosx425.github.io/2021/10/14/Runnable%E6%8E%A5%E5%8F%A3/" title="Runnable接口">
                        <span class="hidden-mobile">Runnable接口</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/yaosx425/yaosx425.github.io/js/events.js" ></script>
<script  src="/yaosx425/yaosx425.github.io/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/yaosx425/yaosx425.github.io/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/yaosx425/yaosx425.github.io/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/yaosx425/yaosx425.github.io/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
